<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Datenaufbereitung in R: Praxisguide | Statistische Analysen mit R in den MINT-Didaktiken Eine Tutorial-Sammlung</title>
  <meta name="description" content="Alles was ich hätte wissen wollen" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Datenaufbereitung in R: Praxisguide | Statistische Analysen mit R in den MINT-Didaktiken Eine Tutorial-Sammlung" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Alles was ich hätte wissen wollen" />
  <meta name="github-repo" content="dbuschhue/P4-Worflow" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Datenaufbereitung in R: Praxisguide | Statistische Analysen mit R in den MINT-Didaktiken Eine Tutorial-Sammlung" />
  
  <meta name="twitter:description" content="Alles was ich hätte wissen wollen" />
  

<meta name="author" content="Tina Grottke, Philipp Möhrke, Marvin Rost, David Buschhüter (Hrsg.)" />


<meta name="date" content="2022-08-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="basiswissen-für-r-praxisguide.html"/>
<link rel="next" href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Files</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> DISCLAIMER</a></li>
<li class="chapter" data-level="2" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html"><i class="fa fa-check"></i><b>2</b> Basiswissen für R: Praxisguide</a>
<ul>
<li class="chapter" data-level="2.1" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#motivation"><i class="fa fa-check"></i><b>2.1</b> Motivation</a></li>
<li class="chapter" data-level="2.2" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#inhalte"><i class="fa fa-check"></i><b>2.2</b> Inhalte</a></li>
<li class="chapter" data-level="2.3" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#rstudio"><i class="fa fa-check"></i><b>2.3</b> RStudio</a></li>
<li class="chapter" data-level="2.4" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#pakete"><i class="fa fa-check"></i><b>2.4</b> Pakete</a></li>
<li class="chapter" data-level="2.5" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#objekte-in-r"><i class="fa fa-check"></i><b>2.5</b> Objekte in R</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#datensätze-typen"><i class="fa fa-check"></i><b>2.5.1</b> Datensätze: Typen</a></li>
<li class="chapter" data-level="2.5.2" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#matrix"><i class="fa fa-check"></i><b>2.5.2</b> Matrix</a></li>
<li class="chapter" data-level="2.5.3" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#listen"><i class="fa fa-check"></i><b>2.5.3</b> Listen</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#variablen-typen"><i class="fa fa-check"></i><b>2.6</b> Variablen: Typen</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#numeric"><i class="fa fa-check"></i><b>2.6.1</b> Numeric</a></li>
<li class="chapter" data-level="2.6.2" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#character"><i class="fa fa-check"></i><b>2.6.2</b> Character</a></li>
<li class="chapter" data-level="2.6.3" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#factor"><i class="fa fa-check"></i><b>2.6.3</b> Factor</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#coden-tipps-tricks"><i class="fa fa-check"></i><b>2.7</b> Coden: Tipps &amp; Tricks</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#umgang-mit-klammern"><i class="fa fa-check"></i><b>2.7.1</b> Umgang mit Klammern</a></li>
<li class="chapter" data-level="2.7.2" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#schleifen"><i class="fa fa-check"></i><b>2.7.2</b> Schleifen</a></li>
<li class="chapter" data-level="2.7.3" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#eigene-funktionen"><i class="fa fa-check"></i><b>2.7.3</b> Eigene Funktionen</a></li>
<li class="chapter" data-level="2.7.4" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#klammern-in-rstudio"><i class="fa fa-check"></i><b>2.7.4</b> Klammern in RStudio</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#übersichtlich-coden"><i class="fa fa-check"></i><b>2.8</b> Übersichtlich Coden</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#schneller-coden-shortcuts"><i class="fa fa-check"></i><b>2.8.1</b> Schneller Coden: Shortcuts</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="basiswissen-für-r-praxisguide.html"><a href="basiswissen-für-r-praxisguide.html#teil-datensaetze"><i class="fa fa-check"></i><b>2.9</b> Datensätze: Teil-Datensätze bilden</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html"><i class="fa fa-check"></i><b>3</b> Datenaufbereitung in R: Praxisguide</a>
<ul>
<li class="chapter" data-level="3.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#motivation-1"><i class="fa fa-check"></i><b>3.1</b> Motivation</a></li>
<li class="chapter" data-level="3.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#inhalte-1"><i class="fa fa-check"></i><b>3.2</b> Inhalte</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#praeventivedatenaufbereitung"><i class="fa fa-check"></i><b>3.2.1</b> Hinweise für quantitative Befragungen – Präventive Datenaufbereitung</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#daten-importieren"><i class="fa fa-check"></i><b>3.3</b> Daten importieren</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#import-von-excel"><i class="fa fa-check"></i><b>3.3.1</b> Import von Excel</a></li>
<li class="chapter" data-level="3.3.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#import-von-csv"><i class="fa fa-check"></i><b>3.3.2</b> Import von CSV</a></li>
<li class="chapter" data-level="3.3.3" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#import-von-spss"><i class="fa fa-check"></i><b>3.3.3</b> Import von SPSS</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#überblick-über-die-daten-verschaffen"><i class="fa fa-check"></i><b>3.4</b> Überblick über die Daten verschaffen</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#erster-überblick-mit-den-funktionen-nrow-ncol-und-view"><i class="fa fa-check"></i><b>3.4.1</b> Erster Überblick mit den Funktionen <code>nrow()</code>, <code>ncol()</code> und <code>View()</code></a></li>
<li class="chapter" data-level="3.4.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#vertiefung-der-view-funktion"><i class="fa fa-check"></i><b>3.4.2</b> Vertiefung der <code>View()</code>-Funktion</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#umbenennen-von-variablen"><i class="fa fa-check"></i><b>3.5</b> Umbenennen von Variablen</a></li>
<li class="chapter" data-level="3.6" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#erste-deskriptive-analyse"><i class="fa fa-check"></i><b>3.6</b> Erste deskriptive Analyse</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#deskriptive-statistiken"><i class="fa fa-check"></i><b>3.6.1</b> Deskriptive Statistiken</a></li>
<li class="chapter" data-level="3.6.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#graphische-übersicht"><i class="fa fa-check"></i><b>3.6.2</b> Graphische Übersicht</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#einen-aufbereitungsplan-machen"><i class="fa fa-check"></i><b>3.7</b> Einen Aufbereitungsplan machen</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#beispiele-für-schmutzige-daten"><i class="fa fa-check"></i><b>3.7.1</b> Beispiele für <em>schmutzige</em> Daten</a></li>
<li class="chapter" data-level="3.7.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#aufplan"><i class="fa fa-check"></i><b>3.7.2</b> Detaillierte Erstellung eines Aufbereitungsplans an einem echten Beispiel</a></li>
<li class="chapter" data-level="3.7.3" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#aufbereitungsplan"><i class="fa fa-check"></i><b>3.7.3</b> Aufbereitungsplan</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#datenaufbereitung-durchführen"><i class="fa fa-check"></i><b>3.8</b> Datenaufbereitung durchführen</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#personencode"><i class="fa fa-check"></i><b>3.8.1</b> Aufbereitung eines Personencodes</a></li>
<li class="chapter" data-level="3.8.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#likert"><i class="fa fa-check"></i><b>3.8.2</b> Aufbereitung Likert-skalierter Variablen</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#nominalvars"><i class="fa fa-check"></i><b>3.9</b> Aufbereitung nominaler Variablen (z. B. Ja/Nein)</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#recodieren-einer-numerischen-variablen"><i class="fa fa-check"></i><b>3.9.1</b> Recodieren einer numerischen Variablen</a></li>
<li class="chapter" data-level="3.9.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#löschen-von-variablen"><i class="fa fa-check"></i><b>3.9.2</b> Löschen von Variablen</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#fortgeschrittene-datenaufbereitung"><i class="fa fa-check"></i><b>3.10</b> Fortgeschrittene Datenaufbereitung</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#zwei-datensätze-verschmelzen"><i class="fa fa-check"></i><b>3.10.1</b> Zwei Datensätze verschmelzen</a></li>
<li class="chapter" data-level="3.10.2" data-path="datenaufbereitung-in-r-praxisguide.html"><a href="datenaufbereitung-in-r-praxisguide.html#zeitformate-in-r"><i class="fa fa-check"></i><b>3.10.2</b> Zeitformate in R</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><i class="fa fa-check"></i><b>4</b> Praxisorientierte Einführung in die Item-Response-Theorie mit dem Fokus auf das Rasch-Modell</a>
<ul>
<li class="chapter" data-level="4.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#motivation-und-konzeptuelle-herleitung"><i class="fa fa-check"></i><b>4.1</b> Motivation und konzeptuelle Herleitung</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#beispiel"><i class="fa fa-check"></i><b>4.1.1</b> Beispiel</a></li>
<li class="chapter" data-level="4.1.2" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#wie-wird-der-beste-fit-gefunden"><i class="fa fa-check"></i><b>4.1.2</b> Wie wird der beste Fit gefunden?</a></li>
<li class="chapter" data-level="4.1.3" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#zum-weiterlesen"><i class="fa fa-check"></i><b>4.1.3</b> zum Weiterlesen</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#der-datensatz"><i class="fa fa-check"></i><b>4.2</b> Der Datensatz</a></li>
<li class="chapter" data-level="4.3" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#laden-der-benötigten-pakete-und-des-datensatzes"><i class="fa fa-check"></i><b>4.3</b> Laden der benötigten Pakete und des Datensatzes</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#paketquellen"><i class="fa fa-check"></i><b>4.3.1</b> Paketquellen</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#modellschätzung"><i class="fa fa-check"></i><b>4.4</b> Modellschätzung</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#deutung-der-aufgabenschwierigkeiten"><i class="fa fa-check"></i><b>4.4.1</b> Deutung der Aufgabenschwierigkeiten</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#erzeugen-einer-wright-map"><i class="fa fa-check"></i><b>4.5</b> Erzeugen einer Wright-Map</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#deutung-der-wright-maps"><i class="fa fa-check"></i><b>4.5.1</b> Deutung der Wright-Maps</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#icc-item-characteristic-curve"><i class="fa fa-check"></i><b>4.6</b> ICC (Item Characteristic Curve)</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#input"><i class="fa fa-check"></i><b>4.6.1</b> Input</a></li>
<li class="chapter" data-level="4.6.2" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#r-befehl-für-generierung-der-icc-in-tam"><i class="fa fa-check"></i><b>4.6.2</b> R-Befehl für Generierung der ICC in TAM</a></li>
<li class="chapter" data-level="4.6.3" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#interpretation-icc-im-rasch-modell-wu2016"><i class="fa fa-check"></i><b>4.6.3</b> Interpretation ICC im Rasch-Modell <span class="citation">(<span>Wu, Tam &amp; Jen, 2016</span>)</span></a></li>
<li class="chapter" data-level="4.6.4" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#gegenüberstellung-leichtes---schweres-item"><i class="fa fa-check"></i><b>4.6.4</b> Gegenüberstellung leichtes - schweres Item</a></li>
<li class="chapter" data-level="4.6.5" data-path="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html"><a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html#gegenüberstellung-icc-rasch---2pl"><i class="fa fa-check"></i><b>4.6.5</b> Gegenüberstellung ICC Rasch - 2PL</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html"><i class="fa fa-check"></i><b>5</b> Auswertungsmöglichkeiten von Sortieraufgaben</a>
<ul>
<li class="chapter" data-level="5.1" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#der-datensatz-1"><i class="fa fa-check"></i><b>5.1</b> Der Datensatz</a></li>
<li class="chapter" data-level="5.2" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#die-auswertungsmöglichkeiten"><i class="fa fa-check"></i><b>5.2</b> Die Auswertungsmöglichkeiten</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#dichotom-sortierung-ist-richtig-oder-falsch"><i class="fa fa-check"></i><b>5.2.1</b> Dichotom: Sortierung ist richtig oder falsch</a></li>
<li class="chapter" data-level="5.2.2" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#summe-der-korrekten-oder-falschen-positionen"><i class="fa fa-check"></i><b>5.2.2</b> Summe der korrekten oder falschen Positionen</a></li>
<li class="chapter" data-level="5.2.3" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#spearman-korrelation"><i class="fa fa-check"></i><b>5.2.3</b> Spearman-Korrelation</a></li>
<li class="chapter" data-level="5.2.4" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#levenshtein-algorithmus"><i class="fa fa-check"></i><b>5.2.4</b> Levenshtein-Algorithmus</a></li>
<li class="chapter" data-level="5.2.5" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#der-bubblesort-algorithmus"><i class="fa fa-check"></i><b>5.2.5</b> Der Bubblesort-Algorithmus</a></li>
<li class="chapter" data-level="5.2.6" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#der-jaro-algorithmus-jaro-distanz"><i class="fa fa-check"></i><b>5.2.6</b> Der Jaro-Algorithmus (Jaro-Distanz)</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="auswertungsmöglichkeiten-von-sortieraufgaben.html"><a href="auswertungsmöglichkeiten-von-sortieraufgaben.html#vergleich-und-diskussion"><i class="fa fa-check"></i><b>5.3</b> Vergleich und Diskussion</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="typische-fehlvorstellungen.html"><a href="typische-fehlvorstellungen.html"><i class="fa fa-check"></i><b>6</b> Typische Fehlvorstellungen</a>
<ul>
<li class="chapter" data-level="6.1" data-path="typische-fehlvorstellungen.html"><a href="typische-fehlvorstellungen.html#das-rasch-modell-berücksichtigt-im-gegensatz-zur-klassischen-testtheorie-welche-aufgaben-richtig-bearbeitet-werden"><i class="fa fa-check"></i><b>6.1</b> „Das Rasch-Modell berücksichtigt im Gegensatz zur klassischen Testtheorie, welche Aufgaben richtig bearbeitet werden“</a></li>
<li class="chapter" data-level="6.2" data-path="typische-fehlvorstellungen.html"><a href="typische-fehlvorstellungen.html#anwendung-eines-t-tests-für-unabhängige-stichproben-auf-abhängige-stichproben"><i class="fa fa-check"></i><b>6.2</b> Anwendung eines t-Tests für unabhängige Stichproben auf abhängige Stichproben</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="glossar.html"><a href="glossar.html"><i class="fa fa-check"></i><b>7</b> Glossar</a></li>
<li class="chapter" data-level="8" data-path="verzeichnis-der-beiträge-und-autorinnen.html"><a href="verzeichnis-der-beiträge-und-autorinnen.html"><i class="fa fa-check"></i><b>8</b> Verzeichnis der Beiträge und Autor*innen</a>
<ul>
<li class="chapter" data-level="8.1" data-path="verzeichnis-der-beiträge-und-autorinnen.html"><a href="verzeichnis-der-beiträge-und-autorinnen.html#kapitel"><i class="fa fa-check"></i><b>8.1</b> Kapitel</a></li>
<li class="chapter" data-level="8.2" data-path="verzeichnis-der-beiträge-und-autorinnen.html"><a href="verzeichnis-der-beiträge-und-autorinnen.html#beiträge-zu-fehlvorstellungen"><i class="fa fa-check"></i><b>8.2</b> Beiträge zu Fehlvorstellungen</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="bibliographie.html"><a href="bibliographie.html"><i class="fa fa-check"></i><b>9</b> Bibliographie</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistische Analysen mit R in den MINT-Didaktiken<br />
Eine Tutorial-Sammlung</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="datenaufbereitung-in-r-praxisguide" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">3</span> Datenaufbereitung in R: Praxisguide<a href="datenaufbereitung-in-r-praxisguide.html#datenaufbereitung-in-r-praxisguide" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><em>Autoren: Daniel Rehfeldt, Martin Brämer</em></p>
<p>Herzlich Willkommen zum Beitrag <em>Datenaufbereitung in R</em>. Um einige Funktionen nutzen zu können, werden zunächst Pakete in R installiert und geladen:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Installiere und lade die benötigten Pakete</span></span>
<span id="cb1-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;xlsx&quot;)</span></span>
<span id="cb1-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;foreign&quot;)</span></span>
<span id="cb1-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;plyr&quot;)</span></span>
<span id="cb1-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># install.packages(&quot;psych&quot;)</span></span>
<span id="cb1-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(xlsx) <span class="co"># hilft beim Import von Excel-Daten</span></span>
<span id="cb1-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(foreign) <span class="co"># hilft beim Import von SPSS-Daten</span></span>
<span id="cb1-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr) <span class="co"># enthält die nützliche rename()-Funktion zum Umbenennen von Variablennamen</span></span>
<span id="cb1-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych) <span class="co"># liefert psychometrische Funktionen</span></span></code></pre></div>
<div id="motivation-1" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Motivation<a href="datenaufbereitung-in-r-praxisguide.html#motivation-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vor jeder statistischen Analyse steht ein nur selten ehrlich beschriebener Prozess, die Datenaufbereitung. Diese ist essenziell, um einen Überblick über die Güte der Rohdaten zu erhalten und überhaupt weitere Analysen adäquat durchführen zu können. Beim manuellen Aufbereiten von Daten, sei es händisch in Excel oder SPSS, kann es sehr schnell zu Unaufmerksamkeiten und demnach zu Fehlern kommen, die aufgrund ihrer Nicht-Nachvollziehbarkeit schwere Konsequenzen für die Qualität des Datenmaterials und somit die spätere Analyse haben können. Wir verdeutlichen das einmal an einem Beispiel:</p>
<p>Eine versehentliche Verschiebung der Spaltennamen <em>um 1 nach rechts</em> kann dazu führen, dass der komplette Datensatz unnachvollziehbar beschädigt wird. Denn im Nachhinein erscheint es gerade bei großen Datensätzen, die bereits verändert wurden, fast unmöglich zu entscheiden, zu welcher Variable die jeweilige Spalte von Werten gehört.</p>
<p>Hier zeigt sich eine Stärke Code-basierter Statistiksoftware: Jede Manipulation am Datensatz ist schriftlich fixiert und jederzeit retrospektiv nachvollzieh- oder veränderbar.
Das praktische Rüstzeug für eine basale Datenaufbereitung in R soll dieser Praxisguide liefern. Das Wissen zu vielen Basis-Funktionen, Datentypen und vielem mehr sind in unserem vorherigen Kapitel <em>Basiswissen für R</em> enthalten, deren Kenntnis in der nachfolgenden statistischen Analyse von Vorteil sein kann.</p>
</div>
<div id="inhalte-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Inhalte<a href="datenaufbereitung-in-r-praxisguide.html#inhalte-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Es handelt sich bei allen fortan genutzten Beispielen um Datensätze, die bei Fragebogen-Erhebungen mit Likert-Skalen sowie Angaben zur Person allgemein oder Ähnlichem entstehen. Eine Übertragbarkeit auf andere quantitative Erhebungsformen ist aber oft gegeben.</p>
<p>Der Praxisguide umfasst diverse übliche Schritte der Datenaufbereitung:</p>
<ol style="list-style-type: decimal">
<li><p>Importieren von Daten</p></li>
<li><p>Überblick über die Daten gewinnen</p></li>
<li><p>Anfertigen eines Plans zur Datenaufbereitung</p></li>
<li><p>Typische Verfahren der Datenaufbereitung (z. B. Manipulieren von Variablen)</p></li>
<li><p>Verschmelzen von Daten (Merging, z. B. bei Längsschnitten).</p></li>
</ol>
<p>Dabei wird bis zum Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#aufplan">3.7.2</a> eher funktionsorientiert und unter Nutzung diverser, teils vereinfachter Datensätze operiert, um wesentliche Funktionen für die Datenaufbereitung in R kennenzulernen. Das Herzstück des Beitrags bildet dann die systematische Aufbereitung eines realen, stark <em>verschmutzten</em> Datensatzes ab Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#aufplan">3.7.2</a>.</p>
<p>Begonnen wird dieser Beitrag aber zunächst mit einer der besten Möglichkeiten der Datenaufbereitung – <em>schmutzige</em> Daten gar nicht erst entstehen zu lassen.</p>
<div id="praeventivedatenaufbereitung" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> Hinweise für quantitative Befragungen – Präventive Datenaufbereitung<a href="datenaufbereitung-in-r-praxisguide.html#praeventivedatenaufbereitung" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Die Datenaufbereitung beginnt nicht erst bei der ersten Betrachtung des Rohdatensatzes, sondern bereits vorher – bei einem datensensiblen Befragungsdesign.
Gemeint sind hiermit alle Maßnahmen innerhalb der Befragungssoftware oder des Papierfragebogens, die den Aufwand einer nachträglichen Aufbereitung verringern.</p>
<p>Ein Beispiel wäre etwa die Nutzung von Personencodes mit Einführung von Restriktionen. Besteht ein solcher Code etwa aus vier Buchstaben und vier Ziffern, so kann ein und dieselbe Person z. B. “ERNW1665” oder “ernw1665” oder “eRnW1665” schreiben. Wird hier – sofern die Erhebungssoftware dies erlaubt – die Restriktion auf Großbuchstaben eingeführt, so ist ein Aufbereitungsschritt gespart. Wenn zudem (beim Online-Fragebogen) die Restriktion eingeführt wird, dass der Fragebogen nur fortgesetzt werden kann, wenn tatsächlich vier Buchstaben, gefolgt von vier Ziffern niedergeschrieben wurden, vermeidet man Codes wie “ERNW16”, “1665” usw. – und ja, dies sind reale Beispiele.</p>
<p>Weiters sollten Antwortoptionen erschöpfend sein <span class="citation">(<a href="#ref-porst_fragebogen_2014" role="doc-biblioref">Porst, 2014</a>)</span>, um die Datenaufbereitung und -interpretation zu gewährleisten. Die Frage <em>Welche der folgenden Fächer belegten Sie im Abitur?</em>, gefolgt von den Ankreuzmöglichkeiten <em>Physik</em> und <em>Chemie</em> führt nämlich zu der Frage, welche Interpretation erfolgt, wenn keine der beiden Möglichkeiten angekreuzt wurde. Hat die Person die Frage übersprungen? Hat sie beide Fächer nicht belegt? Es müsste hier die Antwortoption <em>keine der beiden</em> unbedingt ergänzt werden.
Ein letztes exemplarisches Beispiel ist die Abitur- oder Hochschulzugangsberechtigungsnote. Die Wahl eines Freitextfeldes zur Beantwortung der Frage ist hier unbedingt zu vermeiden, da sonst Antworten wie “sehr gut”, “weiß ich nicht”, “zweikommazwei”, “1.3” oder “1,7” erfolgen können, ein Albtraum für die Datenaufbereitung. Wir empfehlen hier je nach Genauigkeitswunsch entweder a) das Nutzen von Ankreuzmöglichkeiten in <em>Ranges</em>, also “1,0–1,3”, “1,4–1,7”, …, und <em>weiß ich nicht</em> oder bei guter Befragungssoftware das Nutzen von Feldern, die nur die Schreibweise <code>[Ziffer],[Ziffer]</code> zulassen.</p>
</div>
</div>
<div id="daten-importieren" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Daten importieren<a href="datenaufbereitung-in-r-praxisguide.html#daten-importieren" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nun beginnt der tatsächliche Anwendungsfall einer Datenbereinigung mit einem großen und unübersichtlichen Datensatz, der mit dem Import der Daten in R beginnt. Je nach Ausgangsformat der Daten gibt es hierzu eine Anleitung. R bietet den großen Vorteil, dass es mit allen regulären und auch exotischen Datentypen umgehen kann.</p>
<p>An dieser Stelle erscheint es zudem wichtig, eine gängige Praxis beim Erstkontakt mit Rohdaten anzusprechen: Rohdaten sollten sofort nach dem Erhalt kopiert und separat gespeichert werden. Diese Rohdaten sollten <em>in keiner Weise</em> verändert oder manipuliert werden, sie dienen als wertvolle Rückversicherung, falls bei der Datenaufbereitung und/oder dem Abspeichern manipulierter Daten ein gravierender Fehler unterlaufen sollte.</p>
<div id="import-von-excel" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Import von Excel<a href="datenaufbereitung-in-r-praxisguide.html#import-von-excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Daten, die auf <code>.xlsx</code> oder <code>.xls</code> enden, können folgendermaßen importiert werden:</p>
<pre><code>demodata_xlsx &lt;- read.xlsx(&quot;Dateiname.xlsx&quot;, 1) # &quot;Dateiname.xls&quot; bei xls-Dateien </code></pre>
<p>Dies importiert einen Standard-Excel-Datensatz korrekt, der Daten im Excel-Arbeitsblatt 1 enthält und in der ersten Zeile die Variablennamen enthält. Weitere Optionen siehe <a href="https://cran.r-project.org/web/packages/xlsx/xlsx.pdf">hier</a>.</p>
</div>
<div id="import-von-csv" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Import von CSV<a href="datenaufbereitung-in-r-praxisguide.html#import-von-csv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Daten die auf .csv enden, können folgendermaßen importiert werden:</p>
<pre><code>demodata_csv &lt;- read.csv2(file = &quot;Dateiname.csv&quot;)  </code></pre>
<p>Falls der Import fehlschlägt, meist wegen Heterogenität der csv-Formatierungen, gibt es <a href="https://www.rdocumentation.org/packages/utils/versions/3.6.2/topics/read.table">hier</a> Hilfe.</p>
</div>
<div id="import-von-spss" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Import von SPSS<a href="datenaufbereitung-in-r-praxisguide.html#import-von-spss" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Daten die auf <em>.sav</em> enden und aus SPSS stammen, können folgendermaßen importiert werden (mehr Erläuterungen finden sich <a href="https://www.rdocumentation.org/Pakete/foreign/versions/0.8-82/topics/read.spss">hier</a>):</p>
<pre><code>demodata_spss &lt;-
  read.spss(
    &quot;Dateiname.sav&quot;,
    use.value.labels = F,
    to.data.frame = T,
    use.missings = T,
    trim.factor.names = T
  ) </code></pre>
<p>Die angegebenen Optionen stellen in vielen Fällen eine gute Ausgangsbasis dar. Sie werden hier einmal erläutert:</p>
<p><code>use.value.labels=F</code>
Gerade Ratingskalen-Items (z. B. <em>stimme nicht zu</em> bis <em>stimme voll zu</em>) werden beim automatischen Import als Factor-Variablen deklariert (mit z. B. den Levels <em>stimme nicht zu</em>, <em>stimme ein wenig zu</em>, <em>stimme zu</em>, <em>stimme voll zu</em>). Wenn dies gewünscht ist, kann die Option auf <code>TRUE</code> gesetzt werden. Setzt man auf <code>FALSE</code>, so werden die Antwort-Optionen als Zahlen angegeben, also z.B. 1 bis 4. Dies gilt dann aber auch für <em>echte</em> Factor-Variablen, wie das Geschlecht, hier sollte nachträglich im SPSS-Datensatz eine Rückversicherung stattfinden, ob etwa bei der Variablen <code>Geschlecht</code> die Zahl 1 der Ausprägung <em>männlich</em>, <em>weiblich</em> oder <em>divers</em> entsprach.</p>
<p><code>to.data.frame = T</code>
Damit werden SPSS-Daten standardmäßig als Dataframe importiert.</p>
<p><code>use.missings = T</code>
Dies ist relevant, falls in SPSS verschiedene Arten von missing values definiert wurden (z. B. <em>missing at random</em>, <em>missing by design</em> usw.). Diese Informationen bleiben so erhalten.</p>
<p><code>trim.factor.names = T</code>
Factor-Variablen werden beim Import automatisch erkannt, diese Option sorgt dafür, dass am Anfang und Ende eines Factor-Level-Namens keine Leerzeichen stehen, also z.B. <code>"Gruppe 1"</code> statt <code>" Gruppe 1 "</code>.</p>
</div>
</div>
<div id="überblick-über-die-daten-verschaffen" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Überblick über die Daten verschaffen<a href="datenaufbereitung-in-r-praxisguide.html#überblick-über-die-daten-verschaffen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nach dem Daten-Import sollte zunächst ein Überblick über die neuen Dataframes in R gewonnen werden.</p>
<div id="erster-überblick-mit-den-funktionen-nrow-ncol-und-view" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Erster Überblick mit den Funktionen <code>nrow()</code>, <code>ncol()</code> und <code>View()</code><a href="datenaufbereitung-in-r-praxisguide.html#erster-überblick-mit-den-funktionen-nrow-ncol-und-view" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="nrow-und-ncol" class="section level4 hasAnchor" number="3.4.1.1">
<h4><span class="header-section-number">3.4.1.1</span> <code>nrow() und ncol()</code><a href="datenaufbereitung-in-r-praxisguide.html#nrow-und-ncol" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Diese beiden basalen und oft nützlichen Funktionen liefern die Anzahl der Zeilen (<code>nrow()</code>, i. d. R. Proband:innenanzahl) respektive die Anzahl der Spalten (<code>ncol()</code>, i. d. R. Variablenanzahl). Nach der Datenbereinigung (also bspw. dem Entfernen von Missings) kann über <code>nrow()</code> z. B. die Stichprobengröße ermittelt werden. <code>ncol()</code> dient z. B. zur Überprüfung, ob nach komplexen Operationen die verbleibende Variablenzahl plausibel ist.</p>
<p>Wir benötigen zunächst einen Datensatz. Er ist im <a href="https://github.com/dbuschhue/P4-Worflow/blob/master/data_for_chapters/baseknowledge_R/df_unrein_1_neu.rds">GitHub-Verzeichnis</a> dieser Publikation verfügbar.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importiert den Datensatz. Dieser liegt im R-eigenen rds-Format vor:</span></span>
<span id="cb5-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb5-2" aria-hidden="true" tabindex="-1"></a>datensatz_roh <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./data_for_chapters/baseknowledge_R/df_unrein_1_neu.rds&quot;</span>) </span>
<span id="cb5-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co">#speichere ein Duplikat des datensatz_roh für spätere Reaktivierung:</span></span>
<span id="cb5-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb5-5" aria-hidden="true" tabindex="-1"></a>datensatz_roh_duplikat_1 <span class="ot">&lt;-</span> datensatz_roh </span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># View(datensatz_roh) # Dies wird ausgeführt, um einen visuellen Gesamteindruck zu erhalten.</span></span>
<span id="cb6-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Aus View() wird deutlich: </span></span>
<span id="cb6-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1) Erst ab Person 11 sind sinnvolle Personencodes vorhanden </span></span>
<span id="cb6-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (die ersten 10 waren Testdurchläufe der Testleitenden)</span></span>
<span id="cb6-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 2) Die Variable &quot;dozent&quot; enthält IMMER den Text &quot;brämer&quot;</span></span>
<span id="cb6-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Es folgt ein Beispiel zur Nutzung von nrow() und ncol():</span></span>
<span id="cb6-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_roh) <span class="co">#Zeilen (Personen) Zahl vorher</span></span></code></pre></div>
<pre><code>## [1] 546</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb8-1" aria-hidden="true" tabindex="-1"></a>datensatz_bearbeitet <span class="ot">&lt;-</span> datensatz_roh[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),] <span class="co">#Entferne die ersten 10 Zeilen (= Personen)</span></span>
<span id="cb8-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_bearbeitet) <span class="co">#Zeilen (Personen) Zahl hinterher</span></span></code></pre></div>
<pre><code>## [1] 536</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(datensatz_bearbeitet) <span class="co">#Spalten (Variablen) Zahl vorher</span></span></code></pre></div>
<pre><code>## [1] 18</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datensatz_bearbeitet) <span class="co"># Prüfe, an welcher Stelle des Datensatzes die Variable &quot;dozent&quot; steht</span></span></code></pre></div>
<pre><code>##  [1] &quot;pcode&quot;                  &quot;VW.theo&quot;                &quot;VW.prax&quot;               
##  [4] &quot;VW.plan&quot;                &quot;VW.durch&quot;               &quot;VW.reflex&quot;             
##  [7] &quot;Abitur_Fach_Biologie&quot;   &quot;Abitur_Fach_Chemie&quot;     &quot;Abitur_Fach_Geographie&quot;
## [10] &quot;Abitur_Fach_Geschichte&quot; &quot;Abitur_Fach_Informatik&quot; &quot;Abitur_Fach_Physik&quot;    
## [13] &quot;Abitur_Fach_PW&quot;         &quot;geschlecht&quot;             &quot;alter&quot;                 
## [16] &quot;semester.pre&quot;           &quot;abi&quot;                    &quot;dozent&quot;</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Es ist also die Stelle 18</span></span>
<span id="cb14-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb14-3" aria-hidden="true" tabindex="-1"></a>datensatz_bearbeitet <span class="ot">&lt;-</span> datensatz_bearbeitet[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">18</span>)] <span class="co">#entferne Variable 18, dozent.</span></span>
<span id="cb14-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ncol</span>(datensatz_bearbeitet) <span class="co">#Spalten (Variablen) Zahl hinterher</span></span></code></pre></div>
<pre><code>## [1] 17</code></pre>
</div>
</div>
<div id="vertiefung-der-view-funktion" class="section level3 hasAnchor" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Vertiefung der <code>View()</code>-Funktion<a href="datenaufbereitung-in-r-praxisguide.html#vertiefung-der-view-funktion" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Einen, wie oben bereits angedeutet, eher gewohnten, grafischen Überblick gibt die <code>View()</code>-Funktion (vgl. Abb. <a href="datenaufbereitung-in-r-praxisguide.html#fig:view-tab">3.1</a> und <a href="datenaufbereitung-in-r-praxisguide.html#fig:view-funk">3.2</a>), wir stellen vorher noch den Rohdatensatz wieder her:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#wiederherstellen des Rohdatensatzes</span></span>
<span id="cb16-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb16-2" aria-hidden="true" tabindex="-1"></a>datensatz_roh <span class="ot">&lt;-</span> datensatz_roh_duplikat_1</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(datensatz_roh)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:view-tab"></span>
<img src="figs/View.png" alt="View-Tab in RStudio (von Daniel Rehfeldt)"  />
<p class="caption">
Figure 3.1: View-Tab in RStudio (von Daniel Rehfeldt)
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:view-funk"></span>
<img src="figs/View-Funktionalitaet.png" alt="Filter-Funktion und *Show in new Window*-Funktion (von Daniel Rehfeldt)"  />
<p class="caption">
Figure 3.2: Filter-Funktion und <em>Show in new Window</em>-Funktion (von Daniel Rehfeldt)
</p>
</div>
<p>In den Abbildungen <a href="datenaufbereitung-in-r-praxisguide.html#fig:view-tab">3.1</a> und <a href="datenaufbereitung-in-r-praxisguide.html#fig:view-funk">3.2</a> sind die verschiedenen Funktionen innerhalb der View-Ansicht hervorgehoben. Damit lässt sich</p>
<ol style="list-style-type: lower-alpha">
<li>der Datensatz in einem eigenen Fenster anzeigen.</li>
<li>ein Filter hinzufügen (z. B. Ansicht so, dass nur diejenigen Personen zu sehen sind, die Physik im Abitur hatten).</li>
<li>im Datensatz eine Stichwortsuche vollführen.</li>
<li>der Datensatz nach einer Variablen alphabetisch/numerisch sortieren.</li>
</ol>
</div>
</div>
<div id="umbenennen-von-variablen" class="section level2 hasAnchor" number="3.5">
<h2><span class="header-section-number">3.5</span> Umbenennen von Variablen<a href="datenaufbereitung-in-r-praxisguide.html#umbenennen-von-variablen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Es gibt unzählige Wege, Variablen in R umzubenennen. Den für uns anschaulichsten Weg präsentieren wir hier. Der Datensatz für das Beispiel ist im <a href="https://github.com/dbuschhue/P4-Worflow/blob/master/data_for_chapters/data_cleaning/df_POST_1_neu.rds">GitHub-Verzeichnis</a> dieser Publikation verfügbar.</p>
<p>Im Rahmen der <code>rename()</code>-Funktion des <code>plyr</code>-Pakets wird immer wieder die Schreibweise <code>neuer Variablenname = alter Variablenname</code> benutzt. So bleibt stets ersichtlich, welcher Variablenname durch welchen ersetzt wurde:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lade zunächst als Beispiel einen Rohdatensatz mit ungünstigen Variablennamen:</span></span>
<span id="cb18-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb18-2" aria-hidden="true" tabindex="-1"></a>datensatz_unbenannt <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;./data_for_chapters/data_cleaning/df_POST_1_neu.rds&quot;</span>)</span>
<span id="cb18-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfe die Variablennamen:</span></span>
<span id="cb18-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datensatz_unbenannt) </span></code></pre></div>
<pre><code>##  [1] &quot;fr_277654&quot; &quot;fr_277655&quot; &quot;fr_277656&quot; &quot;fr_277657&quot; &quot;fr_277658&quot; &quot;fr_277659&quot;
##  [7] &quot;fr_277660&quot; &quot;fr_277661&quot; &quot;fr_277662&quot; &quot;fr_277663&quot; &quot;fr_277664&quot; &quot;fr_277665&quot;
## [13] &quot;fr_277666&quot; &quot;fr_277667&quot; &quot;fr_277668&quot; &quot;fr_277669&quot; &quot;fr_277670&quot; &quot;fr_277671&quot;</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Benenne um (hierfür wurde vorher eine Zuordnungstabelle o. Ä. aus dem Erhebungsmanual gebraucht):</span></span>
<span id="cb20-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-2" aria-hidden="true" tabindex="-1"></a>datensatz_renamed <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb20-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-3" aria-hidden="true" tabindex="-1"></a>  datensatz_unbenannt,</span>
<span id="cb20-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">replace =</span> <span class="fu">c</span>(</span>
<span id="cb20-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277654&quot;</span> <span class="ot">=</span> <span class="st">&quot;pcode&quot;</span>,</span>
<span id="cb20-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277655&quot;</span> <span class="ot">=</span> <span class="st">&quot;VW.theo&quot;</span>,</span>
<span id="cb20-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277656&quot;</span> <span class="ot">=</span> <span class="st">&quot;VW.prax&quot;</span>,</span>
<span id="cb20-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277657&quot;</span> <span class="ot">=</span> <span class="st">&quot;VW.plan&quot;</span>,</span>
<span id="cb20-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277658&quot;</span> <span class="ot">=</span> <span class="st">&quot;VW.durch&quot;</span>,</span>
<span id="cb20-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277659&quot;</span> <span class="ot">=</span> <span class="st">&quot;VW.reflex&quot;</span>,</span>
<span id="cb20-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277660&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Biologie&quot;</span>,</span>
<span id="cb20-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277661&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Chemie&quot;</span>,</span>
<span id="cb20-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277662&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Geographie&quot;</span>,</span>
<span id="cb20-14"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277663&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Geschichte&quot;</span>,</span>
<span id="cb20-15"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277664&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Informatik&quot;</span>,</span>
<span id="cb20-16"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277665&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_Physik&quot;</span>,</span>
<span id="cb20-17"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277666&quot;</span> <span class="ot">=</span> <span class="st">&quot;Abitur_Fach_PW&quot;</span>,</span>
<span id="cb20-18"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277667&quot;</span> <span class="ot">=</span> <span class="st">&quot;geschlecht&quot;</span>,</span>
<span id="cb20-19"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277668&quot;</span> <span class="ot">=</span> <span class="st">&quot;alter&quot;</span>,</span>
<span id="cb20-20"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277669&quot;</span> <span class="ot">=</span> <span class="st">&quot;semester.pre&quot;</span>,</span>
<span id="cb20-21"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277670&quot;</span> <span class="ot">=</span> <span class="st">&quot;abi&quot;</span>,</span>
<span id="cb20-22"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;fr_277671&quot;</span> <span class="ot">=</span> <span class="st">&quot;dozent&quot;</span></span>
<span id="cb20-23"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-23" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-24"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-25"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-26"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Variablennamen hinterher:</span></span>
<span id="cb20-27"><a href="datenaufbereitung-in-r-praxisguide.html#cb20-27" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datensatz_renamed)</span></code></pre></div>
<pre><code>##  [1] &quot;pcode&quot;                  &quot;VW.theo&quot;                &quot;VW.prax&quot;               
##  [4] &quot;VW.plan&quot;                &quot;VW.durch&quot;               &quot;VW.reflex&quot;             
##  [7] &quot;Abitur_Fach_Biologie&quot;   &quot;Abitur_Fach_Chemie&quot;     &quot;Abitur_Fach_Geographie&quot;
## [10] &quot;Abitur_Fach_Geschichte&quot; &quot;Abitur_Fach_Informatik&quot; &quot;Abitur_Fach_Physik&quot;    
## [13] &quot;Abitur_Fach_PW&quot;         &quot;geschlecht&quot;             &quot;alter&quot;                 
## [16] &quot;semester.pre&quot;           &quot;abi&quot;                    &quot;dozent&quot;</code></pre>
</div>
<div id="erste-deskriptive-analyse" class="section level2 hasAnchor" number="3.6">
<h2><span class="header-section-number">3.6</span> Erste deskriptive Analyse<a href="datenaufbereitung-in-r-praxisguide.html#erste-deskriptive-analyse" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Will man einen ersten Überblick über deskriptive, quantitative Statistiken gewinnen (z. B. für Items aus Skalen oder numerische Kovariaten wie das Alter), so stehen diverse Funktionen zur Verfügung, von denen wir einige nun vorstellen.</p>
<div id="deskriptive-statistiken" class="section level3 hasAnchor" number="3.6.1">
<h3><span class="header-section-number">3.6.1</span> Deskriptive Statistiken<a href="datenaufbereitung-in-r-praxisguide.html#deskriptive-statistiken" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Die <code>summary()</code>-Funktion liefert in Blöcken einen Überblick über jede Variable, inklusive Mittelwert, Median und fehlenden Werten. Nützlich sind zudem die Angaben des Minimal- und Maximalwertes, z. B., um Skalenwerte außerhalb des definierten Bereichs zu erkennen.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datensatz_renamed)</span></code></pre></div>
<pre><code>##               pcode        VW.theo         VW.prax          VW.plan     
##  ANAN0770        :  2   Min.   :1.000   Min.   : 1.000   Min.   :1.000  
##    Anan1913      :  1   1st Qu.:2.000   1st Qu.: 2.000   1st Qu.:1.000  
##  01.01.2000      :  1   Median :3.000   Median : 3.000   Median :2.000  
##  01.04.1987      :  1   Mean   :2.705   Mean   : 3.061   Mean   :2.566  
##  06              :  1   3rd Qu.:4.000   3rd Qu.: 4.000   3rd Qu.:4.000  
##  1.NA2.NA3.284.10:  1   Max.   :5.000   Max.   :99.000   Max.   :6.000  
##  (Other)         :539   NA&#39;s   :221     NA&#39;s   :220      NA&#39;s   :221    
##     VW.durch      VW.reflex     Abitur_Fach_Biologie Abitur_Fach_Chemie
##  Min.   :1.00   Min.   :1.000   Min.   :1            Min.   :1         
##  1st Qu.:2.00   1st Qu.:1.000   1st Qu.:1            1st Qu.:1         
##  Median :3.00   Median :2.000   Median :1            Median :1         
##  Mean   :2.62   Mean   :2.495   Mean   :1            Mean   :1         
##  3rd Qu.:3.00   3rd Qu.:3.000   3rd Qu.:1            3rd Qu.:1         
##  Max.   :6.00   Max.   :6.000   Max.   :1            Max.   :1         
##  NA&#39;s   :220    NA&#39;s   :221     NA&#39;s   :391          NA&#39;s   :466       
##  Abitur_Fach_Geographie Abitur_Fach_Geschichte Abitur_Fach_Informatik
##  Min.   :1              Min.   :1              Min.   :1             
##  1st Qu.:1              1st Qu.:1              1st Qu.:1             
##  Median :1              Median :1              Median :1             
##  Mean   :1              Mean   :1              Mean   :1             
##  3rd Qu.:1              3rd Qu.:1              3rd Qu.:1             
##  Max.   :1              Max.   :1              Max.   :1             
##  NA&#39;s   :459            NA&#39;s   :391            NA&#39;s   :531           
##  Abitur_Fach_Physik Abitur_Fach_PW geschlecht     alter        semester.pre
##  Min.   :1          Min.   :1      1:154      Min.   : 1.000   1 :175      
##  1st Qu.:1          1st Qu.:1      2: 25      1st Qu.: 4.000   3 :  3      
##  Median :1          Median :1      3:  2      Median : 5.000   5 :  1      
##  Mean   :1          Mean   :1      4:365      Mean   : 7.236   NA:367      
##  3rd Qu.:1          3rd Qu.:1                 3rd Qu.: 9.000               
##  Max.   :1          Max.   :1                 Max.   :33.000               
##  NA&#39;s   :476        NA&#39;s   :462               NA&#39;s   :364                  
##       abi           dozent         
##  Min.   :1.100   Length:546        
##  1st Qu.:2.475   Class :character  
##  Median :2.700   Mode  :character  
##  Mean   :2.721                     
##  3rd Qu.:3.100                     
##  Max.   :3.900                     
##  NA&#39;s   :364</code></pre>
<p>Die <code>describe()</code>-Funktion aus dem <code>psych</code>-Package liefert je Variable eine Zeile mit deutlich mehr Statistiken. Es sind gültige Fälle (und damit auch fehlende Werte), Mittelwert, Standardabweichung, Median, Min, Max, Schiefe, Kurtosis und Standardfehler angegeben. Für <code>character</code>-Variablen erhält man allerdings keine sinnvollen Angaben.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(datensatz_renamed)</span></code></pre></div>
<pre><code>##                        vars   n   mean     sd median trimmed    mad min   max
## pcode*                    1 546 272.54 157.70  272.5  272.50 202.37 1.0 545.0
## VW.theo                   2 325   2.70   1.20    3.0    2.69   1.48 1.0   5.0
## VW.prax                   3 326   3.06   5.49    3.0    2.70   1.48 1.0  99.0
## VW.plan                   4 325   2.57   1.34    2.0    2.44   1.48 1.0   6.0
## VW.durch                  5 326   2.62   1.33    3.0    2.50   1.48 1.0   6.0
## VW.reflex                 6 325   2.50   1.28    2.0    2.39   1.48 1.0   6.0
## Abitur_Fach_Biologie      7 155   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_Chemie        8  80   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_Geographie    9  87   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_Geschichte   10 155   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_Informatik   11  15   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_Physik       12  70   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## Abitur_Fach_PW           13  84   1.00   0.00    1.0    1.00   0.00 1.0   1.0
## geschlecht*              14 546   3.06   1.36    4.0    3.20   0.00 1.0   4.0
## alter                    15 182   7.24   5.58    5.0    6.10   2.97 1.0  33.0
## semester.pre*            16 546   3.03   1.40    4.0    3.16   0.00 1.0   4.0
## abi                      17 182   2.72   0.48    2.7    2.74   0.44 1.1   3.9
## dozent*                  18 546   1.00   0.00    1.0    1.00   0.00 1.0   1.0
##                        range  skew kurtosis   se
## pcode*                 544.0  0.00    -1.21 6.75
## VW.theo                  4.0  0.10    -1.15 0.07
## VW.prax                 98.0 16.34   282.54 0.30
## VW.plan                  5.0  0.48    -0.78 0.07
## VW.durch                 5.0  0.51    -0.53 0.07
## VW.reflex                5.0  0.49    -0.75 0.07
## Abitur_Fach_Biologie     0.0   NaN      NaN 0.00
## Abitur_Fach_Chemie       0.0   NaN      NaN 0.00
## Abitur_Fach_Geographie   0.0   NaN      NaN 0.00
## Abitur_Fach_Geschichte   0.0   NaN      NaN 0.00
## Abitur_Fach_Informatik   0.0   NaN      NaN 0.00
## Abitur_Fach_Physik       0.0   NaN      NaN 0.00
## Abitur_Fach_PW           0.0   NaN      NaN 0.00
## geschlecht*              3.0 -0.78    -1.34 0.06
## alter                   32.0  2.15     5.14 0.41
## semester.pre*            3.0 -0.74    -1.44 0.06
## abi                      2.8 -0.33     1.07 0.04
## dozent*                  0.0   NaN      NaN 0.00</code></pre>
<p>Für deskriptive Statistiken bei Gruppenvergleichen lohnt sich ein Blick auf <code>describeBy()</code> aus dem <code>psych</code>-Package. Hier wird über ein zweites Argument <code>group = Gruppierungsvariable</code> eine Variable festgelegt, die die Auswertung je Gruppe separat ermöglicht. Der Output zeigt die identischen Statistiken wie <code>describe()</code>, allerdings je Gruppe.
Empfehlenswert ist diese Funktion aber meist erst nach einer groben Datenbereinigung, in unserem Fall müsste beispielweise bei der Variablen <em>Abitur_Fach_Physik</em> der Wert <code>NA</code> teils durch 0 ersetzt werden, mehr dazu in Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#nominalvars">3.9</a>.</p>
<p>Soll ein Überblick über Kreuztabellen gewonnen werden, bietet sich die <code>table()</code>-Funktion an. Diese liefert theoretisch in unserem Beispiel die Anzahlen der Proband:innen, die sowohl Physik als auch Biologie im Abitur belegten, die Anzahl der Proband:innen, die weder Physik noch Biologie belegten und die Anzahlen derjenigen, die je eines, aber nicht das andere belegten.</p>
<p>Die erste Variable in <code>table(Variable 1, Variable 2)</code> steht im Output immer links und die zweite oben.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datensatz_renamed<span class="sc">$</span>Abitur_Fach_Biologie, datensatz_renamed<span class="sc">$</span>Abitur_Fach_Physik)</span></code></pre></div>
<pre><code>##    
##      1
##   1 56</code></pre>
<p>Interpretation: Es wird nur der Fall (1, 1) angezeigt, also diejenigen Personen, die sowohl Physik, als auch Biologie belegten. Weshalb dies so angezeigt wird, kann über eine Inspektion mittels <code>View()</code> nachvollzogen werden:</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(datensatz_renamed[,<span class="fu">c</span>(<span class="st">&quot;Abitur_Fach_Physik&quot;</span>,<span class="st">&quot;Abitur_Fach_Biologie&quot;</span>)])</span></code></pre></div>
<p>Es ist hier ersichtlich, dass im Datensatz (durch die Erhebungssoftware begründet) je <code>NA</code>, also ein fehlender Wert vergeben wurde für <code>nicht im Abitur belegt</code>. R schließt diese fehlenden Werte bei vielen Funktionen aus Analysen aus.</p>
<p>Es gibt aber auch oft Möglichkeiten, diese <code>NA</code> in der Analyse anzuzeigen, bei der <code>table()</code>-Funktion gelingt dies mit <code>useNA</code>:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datensatz_renamed<span class="sc">$</span>Abitur_Fach_Biologie, datensatz_renamed<span class="sc">$</span>Abitur_Fach_Physik, <span class="at">useNA =</span> <span class="st">&quot;always&quot;</span>)</span></code></pre></div>
<pre><code>##       
##          1 &lt;NA&gt;
##   1     56   99
##   &lt;NA&gt;  14  377</code></pre>
<p>Interpretation: 377 Studierende belegten weder Physik noch Biologie, 56 beides, 14 nur Physik und 99 nur Biologie.</p>
<p>Notiz für die spätere umfassende Datenaufbereitung: Die <code>NAs</code> in den Abitur-Variablen sollten in typische Werte wie z. B. <em>0 = nein</em> überführt werden.</p>
</div>
<div id="graphische-übersicht" class="section level3 hasAnchor" number="3.6.2">
<h3><span class="header-section-number">3.6.2</span> Graphische Übersicht<a href="datenaufbereitung-in-r-praxisguide.html#graphische-übersicht" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>hist()</code> und <code>plot()</code></p>
<p>Für nummerische Variablen kann mittels <code>hist(Datensatz$Variable)</code> ein Histogramm erzeugt werden:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(datensatz_renamed<span class="sc">$</span>alter)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histdf"></span>
<img src="rehfeldt_2_datenaufbereitung_files/figure-html/histdf-1.png" alt="Histogramm" width="672" />
<p class="caption">
Figure 3.3: Histogramm
</p>
</div>
<p>Interpretation: Hier ist zukünftig wohl eine Datenaufbereitung nötig, es handelte sich nämlich ausschließlich um erwachsene Studierende und das Alter umfasst im Histogramm scheinbar auch Kinder und Jugendliche.</p>
<p>Die Funktion <code>plot(Datensatz$Variable1, Datensatz$Variable2)</code> kann einen Scatterplot erzeugen:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(datensatz_renamed<span class="sc">$</span>alter, datensatz_renamed<span class="sc">$</span>VW.prax)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:plotdf"></span>
<img src="rehfeldt_2_datenaufbereitung_files/figure-html/plotdf-1.png" alt="Scatterplot" width="672" />
<p class="caption">
Figure 3.4: Scatterplot
</p>
</div>
<p>Interpretation: In der Variablen <code>VW.prax</code> scheint es einen Ausreißer in der Größenordnung 100 zu geben. Eigentlich verläuft die Skala im Bereich 1 bis 6.</p>
<p>Dies sind zwei basale Visualisierungsoptionen, weitere, professionellere Optionen liefert z. B. das Paket <code>ggplot</code>. Damit gelingt auch eine professionell gestaltete Präsentation von Analyseergebnissen, nachfolgend finden sich Beispiele:</p>
<div class="figure">
<img src="figs/ggplot.jpg" alt="" />
<p class="caption">Beispiel-Visualisierungen ggplot (von plosone-phylo, lizensiert unter CC BY 2.0. <a href="https://creativecommons.org/licenses/by/2.0/?ref=openverse" class="uri">https://creativecommons.org/licenses/by/2.0/?ref=openverse</a>.)</p>
</div>
</div>
</div>
<div id="einen-aufbereitungsplan-machen" class="section level2 hasAnchor" number="3.7">
<h2><span class="header-section-number">3.7</span> Einen Aufbereitungsplan machen<a href="datenaufbereitung-in-r-praxisguide.html#einen-aufbereitungsplan-machen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="beispiele-für-schmutzige-daten" class="section level3 hasAnchor" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Beispiele für <em>schmutzige</em> Daten<a href="datenaufbereitung-in-r-praxisguide.html#beispiele-für-schmutzige-daten" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Nachdem ein Überblick über die Daten gewonnen wurde, sind bereits einige Bereinigungsschritte deutlich geworden, hier ein paar Beispiele:</p>
<ul>
<li>Es gibt leere oder spaltenweit identisch ausgeprägte Variablen, z. B. <em>Dozent</em>, stets mit der Ausprägung <em>Brämer</em>.</li>
<li>Variablennamen sind nicht adäquat, das Programm Unizensus der Freien Universität Berlin etwa liefert standardmäßig durchnummerierte Variablennamen wie <em>fr_122350</em>, die nichts über den Inhalt der Variablen aussagen und aussagekräftig umbenannt werden sollten.</li>
<li>Es existieren leere Zeilen, also Proband:innen, die keine Frage beantwortet haben. Dies können Testversuche der Testentwickelnden vor dem eigentlichen Befragungsstart gewesen sein oder schlicht Proband:innen, die die Umfrage nur scheinbar absolviert haben.</li>
<li>Es gibt identische Fälle (Zeilen) im Datensatz. Dies kann Erhebungssoftware-bedingt sein oder durch Verschmelzen von Datensätzen passieren.</li>
<li>Variablen weisen inadäquate Ausprägungen auf, dies konnte bereits im Scatterplot in Abb. <a href="datenaufbereitung-in-r-praxisguide.html#fig:plotdf">3.4</a> vermutet werden. Ein anderes Beispiel sind Variablen wie <em>Seminar</em> mit den Ausprägungen 1, 2 und 3. Diese könnte bspw. eine Frage an die Proband:innen danach sein, welches Seminar sie gerade besuchen, das bei Herrn Müller, bei Frau Genf oder bei Frau Darn. Je nach Anordnung dieser Antwortoptionen kann nun 1 für Herrn Müller, Frau Genf oder Frau Darn stehen, dies sollte deutlicher aus der Variablen herauszulesen sein, beispielweise über die Bennenung als <code>factor</code>-Variablen (vgl. z. B. Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#nominalvars">3.9</a>).</li>
<li>Likert-skalierte Variablen sind manchmal invertiert, z. B. wenn bei Fragebögen einmal positiv und einmal negativ gepolt befragt wird (<em>Physik macht mir Spaß.</em> vs. <em>Physik reizt mich nicht.</em>).</li>
<li>Zur Anonymisierung verwendete Personencodes wurden von den Proband:innen uneinheitlich eingegeben, etwa <code>ERHU0502</code>, <code>ebji8706</code>, <code>ER33</code> usw.</li>
<li>Eine Variable enthält versetzte Werte: Beispiel: <em>Alter in Jahren</em> wurde über ein Dropdown-Menü mit den Zahlen 17 bis 70 (für Studierende) erfragt. Nun setzt das Erhebungsprogramm z. B. eine “1” für 17 Jahre, eine “2” für 18 Jahre usw. Es gibt also einen Versatz von 16 Jahren.</li>
<li>Textlastige Variablen weisen Leerzeichen o. Ä. am Anfang und/oder Ende der Antwort auf. Ein Beispiel: Die Variable <em>Kommentar</em> wird zur Erfassung von Kommentaren zur Erhebung genutzt und darf mit bis zu 160 Zeichen beschrieben werden. Darin finden sich Antworten wie “     Ich fand die Befragung zu lang     ”. Dies kann zu Darstellungsproblemen in R führen.</li>
<li>Beim Import von Variablen kann die automatische Erkennung und Faktorisierung von Variablen nützlich sein, die numerischen Ausprägungen der Antwortoptionen sind allerdings manchmal unbrauchbar. Ein Beispiel: Die Variable <code>geschlecht</code> mit Antwortoptionen wie <em>männlich</em>, <em>weiblich</em>, <em>divers</em> , <em>keine Angabe</em> wurde beim Import automatisch faktorisiert. Die zu den Labels <em>männlich</em>, <em>weiblich</em>, <em>divers</em>, <em>keine Angabe</em> gehörenden numerischen Werte wurden als 2, 3, 4 und 5 festgelegt.</li>
<li>Fehlende Werte enthalten eigentlich Informationen: Eine Frage wie <em>Welche dieser Fächer belegten Sie im Abitur (Mehrfachantworten möglich)?</em></li>
</ul>
<ol style="list-style-type: lower-alpha">
<li>Physik</li>
<li>Chemie</li>
<li>Biologie</li>
</ol>
<p>Dies wird von mancher Erhebungs-Software in drei dichotome <em>Ja/NA-Variablen</em> aufgeteilt, in denen sie das setzen eines Kreuzes als <em>Ja</em>, das weglassen als <code>NA</code> registrieren. Das Weglassen des Kreuzes entspricht in diesem Beispiel allerdings einem <em>Nein</em>. Steht jedoch bei allen drei Fächern ein <code>NA</code>, so ist nicht klar, ob die Person die Frage einfach nicht beantwortet hat, oder ob sie tatsächlich alle drei Fächer nicht im Abitur belegt hatte. Eine weitere Antwortoption <em>keine dieser drei</em> oder eine freie Antwortmöglichkeit <em>Sonstiges, und zwar</em> wäre hier sinnvoll (vgl. Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#praeventivedatenaufbereitung">3.2.1</a>).</p>
</div>
<div id="aufplan" class="section level3 hasAnchor" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Detaillierte Erstellung eines Aufbereitungsplans an einem echten Beispiel<a href="datenaufbereitung-in-r-praxisguide.html#aufplan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Wir starten mit dem Import der Rohdaten und mit der <code>View()</code>-Funktion, um Informationen für unseren Aufbereitungsplan zu erhalten:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importiere Rohdaten. Diese liegen hier im R-eigenen rds-Format vor:</span></span>
<span id="cb33-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb33-2" aria-hidden="true" tabindex="-1"></a>datensatz_roh <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">&quot;./data_for_chapters/data_cleaning/df_POST_1_neu.rds&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(datensatz_roh)</span></code></pre></div>
<p>Zunächst sollte ein Umbennenen der Variablen erfolgen. Hilfreich kann dazu das Original-Befragungsdokument sein oder eine Tabelle, die vor der Befragung die Reihenfolge der Items festlegte (Noch besser wäre eine Befragungssoftware, in der die Namen selbst festgelegt werden können, z. B. <a href="https://www.soscisurvey.de/en/index">SosciSurvey</a>).</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-1" aria-hidden="true" tabindex="-1"></a>datensatz_renamed <span class="ot">&lt;-</span> plyr<span class="sc">::</span><span class="fu">rename</span>(datensatz_roh,</span>
<span id="cb35-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">replace=</span><span class="fu">c</span>(<span class="st">&quot;fr_277654&quot;</span><span class="ot">=</span><span class="st">&quot;pcode&quot;</span>,</span>
<span id="cb35-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-3" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277655&quot;</span><span class="ot">=</span><span class="st">&quot;VW.theo&quot;</span>,</span>
<span id="cb35-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-4" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277656&quot;</span><span class="ot">=</span><span class="st">&quot;VW.prax&quot;</span>,</span>
<span id="cb35-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-5" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277657&quot;</span><span class="ot">=</span><span class="st">&quot;VW.plan&quot;</span>,</span>
<span id="cb35-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-6" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277658&quot;</span><span class="ot">=</span><span class="st">&quot;VW.durch&quot;</span>,</span>
<span id="cb35-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-7" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277659&quot;</span><span class="ot">=</span><span class="st">&quot;VW.reflex&quot;</span>,</span>
<span id="cb35-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-8" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277660&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Biologie&quot;</span>,</span>
<span id="cb35-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-9" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277661&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Chemie&quot;</span>,</span>
<span id="cb35-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-10" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277662&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Geographie&quot;</span>,</span>
<span id="cb35-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-11" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277663&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Geschichte&quot;</span>,</span>
<span id="cb35-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-12" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277664&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Informatik&quot;</span>,</span>
<span id="cb35-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-13" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277665&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_Physik&quot;</span>,</span>
<span id="cb35-14"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-14" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277666&quot;</span><span class="ot">=</span><span class="st">&quot;Abitur_Fach_PW&quot;</span>,</span>
<span id="cb35-15"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-15" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277667&quot;</span><span class="ot">=</span><span class="st">&quot;geschlecht&quot;</span>,</span>
<span id="cb35-16"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-16" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277668&quot;</span><span class="ot">=</span><span class="st">&quot;alter&quot;</span>,</span>
<span id="cb35-17"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-17" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277669&quot;</span><span class="ot">=</span><span class="st">&quot;semester.pre&quot;</span>,</span>
<span id="cb35-18"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-18" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277670&quot;</span><span class="ot">=</span><span class="st">&quot;abi&quot;</span>,</span>
<span id="cb35-19"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-19" aria-hidden="true" tabindex="-1"></a>                             <span class="st">&quot;fr_277671&quot;</span><span class="ot">=</span><span class="st">&quot;dozent&quot;</span></span>
<span id="cb35-20"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-20" aria-hidden="true" tabindex="-1"></a>                   ))</span>
<span id="cb35-21"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-21" aria-hidden="true" tabindex="-1"></a><span class="co">#Überprüfe:</span></span>
<span id="cb35-22"><a href="datenaufbereitung-in-r-praxisguide.html#cb35-22" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(datensatz_renamed)</span></code></pre></div>
<pre><code>##  [1] &quot;pcode&quot;                  &quot;VW.theo&quot;                &quot;VW.prax&quot;               
##  [4] &quot;VW.plan&quot;                &quot;VW.durch&quot;               &quot;VW.reflex&quot;             
##  [7] &quot;Abitur_Fach_Biologie&quot;   &quot;Abitur_Fach_Chemie&quot;     &quot;Abitur_Fach_Geographie&quot;
## [10] &quot;Abitur_Fach_Geschichte&quot; &quot;Abitur_Fach_Informatik&quot; &quot;Abitur_Fach_Physik&quot;    
## [13] &quot;Abitur_Fach_PW&quot;         &quot;geschlecht&quot;             &quot;alter&quot;                 
## [16] &quot;semester.pre&quot;           &quot;abi&quot;                    &quot;dozent&quot;</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Überblicke den Datensatz:</span></span>
<span id="cb37-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(datensatz_renamed)</span></code></pre></div>
<p>Die erste Variable stellt augenscheinlich den Personencode (<em>pcode</em>) dar. Für unsere Studie hatten wir einen Personencode genutzt, der aus vier Großbuchstaben und vier Ziffern bestand.
Wir entdecken hier folgende Unzulänglichkeiten (z. B. über <code>View(df)</code>):</p>
<ol style="list-style-type: decimal">
<li>Manche pcodes enthalten ein Datum.</li>
<li>Manche pcodes sind kürzer als acht Stellen.</li>
<li>Manche pcodes sind länger als acht Stellen.</li>
<li>Manche pcodes enthalten Kleinbuchstaben.</li>
<li>Es gibt Kombinationen aus den obigen vier Fällen.</li>
</ol>
<p>Zudem sollte auf doppelt vorkommende Personencodes geprüft werden, die ggf. ausgeschlossen werden müssen, da es sich um doppelte Zeilen handeln könnte.</p>
<p>Wir können für den Aufbereitungsplan also schreiben:</p>
<pre><code># Aufbereitungsplan
    # Personencode (1. Spalte, pcode)
        # Suche nach pcodes kleiner/größer 8 Stellen und ersetze durch NA
        # Ersetze Kleinbuchstaben durch Großbuchstaben
        # Suche nach pcodes mit Datum (z. B. Punkt &quot;.&quot; suchen)  und ersetze durch NA
        # Suche nach doppelten pcodes und lösche Zeile, falls Duplikat einer anderen Zeile
        # Prüfe mit View(), ob danach noch Aufbereitung nötig</code></pre>
<p>Zu beachten ist hier, dass mit denjenigen Bereinigungen gestartet wird, die möglichst viele Fälle erfassen. So ist etwa das Datum “01.01.2001” auch länger als 8 Zeichen, wird also durch den ersten Punkt in unserer Liste gleich miterfasst.
Weiter kann Ausschau gehalten werden nach Bereinigungen, die global für alle Personencodes ausgeführt werden können, wie hier das Ersetzen von Klein- durch Großbuchstaben. So wird in weiten Teilen vermieden, jeden unregelmäßigen pcode einzeln verändern zu müssen.
Entscheidend ist am Ende das Prüfen, ob weitere Aufbereitungen nötig sind, hier verbleiben dann manchmal Fälle, die tatsächlich einzeln zu ändern sind.</p>
<p>Anmerkung: Zum Erhalt von Daten kann statt unregelmäßige pcodes <code>NA</code> zu setzen auch milder verfahren werden. Denkbar wäre z. B. das speichern der <em>Roh-Personencodes</em> in einer neuen Variablen <code>pcode_roh</code>, um bei späterem <em>matching</em> von Personencodes (z. B. Längsschnitt) bei hinreichend ähnlichen, unkonformen pcodes doch noch ein matching zu erhalten.</p>
<p>Die Variablen in den Spalten 2 bis 6 stellen Likert-skalierte Items zur Abfrage von Vorwissen von 1 (niedrig) bis 6 (hoch) dar. Hier fällt auf, dass sehr viele Personen fehlende Werte (<code>NA</code>) aufweisen. Während der Umgang mit fehlenden Werten nicht Teil dieses Beitrags ist, kann zumindest für unseren Aufbereitungsplan festgehalten werden, dass Personen mit sehr hohen missing-Anteilen (z. B. 60%) als nicht valide Datenquellen gelten und aus der Analyse ausgeschlossen werden können.
Zusätzlich kann gerade bei Likert-skalierten, also rein numerischen Variablen noch einmal geschaut werden, ob alle Ausprägungen auch im intendierten Bereich (hier 1 bis 6) liegen.</p>
<p>Dies können wir schnell mit der <code>summary()</code>-Funktion prüfen:</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datensatz_renamed[,<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<pre><code>##     VW.theo         VW.prax          VW.plan         VW.durch   
##  Min.   :1.000   Min.   : 1.000   Min.   :1.000   Min.   :1.00  
##  1st Qu.:2.000   1st Qu.: 2.000   1st Qu.:1.000   1st Qu.:2.00  
##  Median :3.000   Median : 3.000   Median :2.000   Median :3.00  
##  Mean   :2.705   Mean   : 3.061   Mean   :2.566   Mean   :2.62  
##  3rd Qu.:4.000   3rd Qu.: 4.000   3rd Qu.:4.000   3rd Qu.:3.00  
##  Max.   :5.000   Max.   :99.000   Max.   :6.000   Max.   :6.00  
##  NA&#39;s   :221     NA&#39;s   :220      NA&#39;s   :221     NA&#39;s   :220   
##    VW.reflex    
##  Min.   :1.000  
##  1st Qu.:1.000  
##  Median :2.000  
##  Mean   :2.495  
##  3rd Qu.:3.000  
##  Max.   :6.000  
##  NA&#39;s   :221</code></pre>
<p>Die Variable <code>VW.prax</code> weist einen maximalen Wert 99 auf, der wahrscheinlich einem fehlenden Wert im importierten Datenformat entsprach. Eine Nachprüfung ergab, dass es sich hierbei um einen regulären fehlenden Wert handelte.</p>
<p>Zudem ist, das wissen wir aus der Erhebung, das Skalen-Item <code>VW.reflex</code> invertiert gepolt (<em>Ich hatte kein besonderes Vorwissen zum Thema Reflexion.</em>), so dass eine Umpolung erfolgen muss, wenn etwa später Skalenscores berechnet werden sollen.</p>
<p>Wir fügen also zum Aufbereitungsplan hinzu:</p>
<pre><code>#Likert-skalierte Variablen allgemein
    #Ersetze in allen Likert-skalierten Variablen &quot;99&quot; durch NA
#Variablen Vorwissen (2 bis 6)
    #Schließe Personen aus, die in ALLEN Variablen missing-Quoten von über 60% aufweisen.
# Variable VW.reflex: Umpolen</code></pre>
<p>Hierbei ist die Reihenfolge der beiden Operationen wichtig, da durch die erste Bereinigung neue NAs entstehen könnten.</p>
<p>Weiter geht es mit den Variablen zur Wahl der Abiturfächer in den Spalten 7 bis 13. Hier ist ersichtlich, dass es anscheinend nur die Ausprägungen <code>NA</code> und 1 gibt, wir prüfen kurz mit der <code>summary()</code>-Funktion und es bestätigt sich. Die Items waren so gestellt, dass die Personen je Abiturfach entweder ein Häkchen setzen konnten für <em>im Abitur belegt</em> oder das Ankreuzfeld leer ließen für <em>nicht im Abitur belegt</em>. Problematisch ist nun, dass kein Wert in den Variablen existiert, der auf ein klares <em>Nein</em> hindeutet. Es finden sich nur <code>NAs</code>, die entweder</p>
<ol style="list-style-type: lower-alpha">
<li>bedeuten, dass ein Fach <strong>nicht</strong> im Abitur gewählt wurde oder</li>
<li>dass es sich um einen fehlenden Wert handelt, die Person etwa die Frage übersprungen hat.</li>
</ol>
<p>Dieser Fall stellt also eine Herausforderung für die Datenbereinigung dar.
Nach einiger Überlegung kann folgendes festgehalten werden:</p>
<ol style="list-style-type: decimal">
<li>Personen, die mindestens bei einem Fach eine 1 für <em>Ja</em> aufweisen, können wohl guten Gewissens als Personen angesehen werden, die alle Fragen zum Abitur beantwortet haben. Die <code>NAs</code> in den je anderen Abitur-Variablen dieser Personen können also <code>0 = Nein</code> gesetzt werden.</li>
<li>Schwieriger ist es bei Personen, die <strong>überall</strong> in den Abitur-Variablen <code>NA</code> aufweisen. Aufgrund der Fülle an ankreuzbaren Abiturfächern kann allerdings mit recht gutem Gewissen darauf geschlussfolgert werden, dass die Personen tatsächlich diese Items nicht bearbeitet haben, die <code>NAs</code> bleiben hier also bestehen.</li>
<li>Wenn diese Änderungen vorgenommen sind, könnten diese Variablen in <code>Factor</code>-Variablen mit <code>0 = nein</code> und <code>1 = ja</code> umgewandelt werden.</li>
</ol>
<p>Wir ergänzen für den Aufbereitungsplan:</p>
<pre><code># Abitur-Fachwahl-Variablen (7 bis 13)
    # Ersetze nur für Personen mit mind. einer 1 = &quot;ja&quot; die NAs in den Abitur-Fachwahl-
    # Variablen durch 0 = Nein
    # Wandle die Variablen in Factor-Variablen (0=nein, 1=ja) um</code></pre>
<p>Die nächste Variable ist <code>geschlecht</code> mit den Ausprägungen 1, 2, 3 und 4. Zur Identifikation, welche der Zahlen zu welchem der Geschlechter (weiblich, männlich, divers, keine Angabe) gehören, kann wieder ein Blick in das Befragungstool oder das Forschungstagebuch helfen. In diesem Fall stellte sich heraus: <code>1=weiblich, 2=männlich, 3=divers, 4=keine Angabe</code>. Das Geschlecht ist eine prädestinierte <code>Factor</code>-Variable, da sie oft zur Gruppenbildung herangezogen wird. Wir halten also im Aufbereitungsplan fest:</p>
<pre><code># Geschlecht (14)
    # Wandle in Factor-Variable um, 1=weiblich, 2=männlich, 3=divers, 4=keine Angabe</code></pre>
<p>Bei der folgenden Variablen <code>alter</code> wird es schwieriger. Ein Blick über die <code>table()</code>-Funktion und die Abbildung <a href="datenaufbereitung-in-r-praxisguide.html#fig:histdf">3.3</a> zeigt, dass die Ausprägungen zwischen 1 und 33 liegen, mit einer Häufung um die Ausprägung 4.
Auch hier kann ein Blick in das Befragungsinstrument helfen. Es wurde hier mit Ankreuzoptionen gearbeitet, die erste war das Alter 17, die zweite 18 usw. Die Forscher:innen wollten damit vermeiden, dass bei einem z. B. offenen Angabefeld Angaben wie “dreiunddreißig” o. Ä. gemacht werden. Da 17 nun dem ersten Ankreuzfeld entsprach, scheint die Befragungssoftware dafür eine 1 gesetzt zu haben. Es gilt also <code>1 = 17, 2 = 18</code> usw. Die Daten sind also systematisch zu verändern mit der Operation <code>+16</code>.
Wir ergänzen zum Aufbereitungsplan:</p>
<pre><code># Alter (15)
    # Addiere 16 auf alle Altersangaben</code></pre>
<p>Die drittletzte Variable <code>semester.pre</code> stellt das Hochschulsemester zum Befragungszeitpunkt (hier PRE) dar. Über <code>table()</code> wird ersichtlich, dass trotz Befragung im <em>1. Semester</em> nicht alle Ausprägungen 1 sind, es sind drei Personen im 3. und eine Person im 5. Semester vorhanden. Die Variable muss augenscheinlich nicht bereinigt werden.
Die vorletzte Variable <code>abi</code> enthält die numerische Hochschulzugangsberechtigungsnote. Ein Blick in die <code>summary()</code>-Funktion zeigt ein Minimum von 1.1 und ein Maximum von 3.9. Die Variable scheint ebenso keine Datenbereinigung zu benötigen.
Die letzte Variable <code>dozent</code> enthält buchstäblich immer denselben Wert, nämlich den Text (<em>String</em>) <code>Brämer</code>. Ist geplant, weitere Erhebungen bei anderen Dozierenden zu unternehmen, kann diese Variable nützlich werden, um etwa Dozierendeneffekte einer Intervention zu untersuchen. In unserem Fall ist allerdings lediglich eine PRE-POST-Untersuchung mit stets demselben Dozenten <em>Brämer</em> geplant gewesen, daher kann diese – vom Befragungstool automatisch kreierte – Variable einfach gelöscht werden:</p>
<pre><code># Dozent (18)
    #lösche die Variable</code></pre>
<p>Zu guter Letzt sollte noch ein Blick auf die Variablentypen geworfen werden, vor allem <code>factor</code>-Variablen verhalten sich teils wenig intuitiv und können zunächst einmal in <code>Character</code> (Text) oder <code>Numeric</code> (Zahl) umgewandelt werden.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datensatz_renamed) <span class="co">#zeigt detaillierte Informationen zu u.a. den Variablentypen im Datensatz</span></span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    546 obs. of  18 variables:
##  $ pcode                 : Factor w/ 545 levels &quot;  Anan1913  &quot;,..: 2 3 4 5 6 7 8 9 10 11 ...
##  $ VW.theo               : num  4 3 3 2 5 3 2 1 3 4 ...
##  $ VW.prax               : num  4 4 3 1 5 4 2 1 3 3 ...
##  $ VW.plan               : num  2 5 4 1 4 4 5 1 3 2 ...
##  $ VW.durch              : num  2 4 4 1 4 4 5 1 3 2 ...
##  $ VW.reflex             : num  5 4 4 2 5 4 2 1 4 3 ...
##  $ Abitur_Fach_Biologie  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_Chemie    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_Geographie: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_Geschichte: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_Informatik: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_Physik    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ Abitur_Fach_PW        : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ geschlecht            : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 4 4 4 4 4 4 4 4 4 4 ...
##  $ alter                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ semester.pre          : Factor w/ 4 levels &quot;1&quot;,&quot;3&quot;,&quot;5&quot;,&quot;NA&quot;: 4 4 4 4 4 4 4 4 4 4 ...
##  $ abi                   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ dozent                : chr  &quot;Brämer&quot; &quot;Brämer&quot; &quot;Brämer&quot; &quot;Brämer&quot; ...</code></pre>
<p>Es zeigt sich, dass folgende Variablen als Factor vorliegen:</p>
<ul>
<li><code>pcode</code> <span class="math inline">\(\Rightarrow\)</span> ungünstig, sollte in Character umgewandelt werden, um leichter Umwandlungen vornehmen zu können</li>
<li><code>geschlecht</code> <span class="math inline">\(\Rightarrow\)</span> ok, sofern die Ziffern ein label erhalten (weiblich, männlich usw.)</li>
<li><code>semester.pre</code> <span class="math inline">\(\Rightarrow\)</span> ok</li>
</ul>
<p>Den ersten Punkt fügen wir also noch zu unserem Aufbereitungsplan hinzu, und zwar bevor andere Operationen am pcode vorgenommen werden.</p>
</div>
<div id="aufbereitungsplan" class="section level3 hasAnchor" number="3.7.3">
<h3><span class="header-section-number">3.7.3</span> Aufbereitungsplan<a href="datenaufbereitung-in-r-praxisguide.html#aufbereitungsplan" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Es ist geschafft, der finale Aufbereitungsplan ist erstellt:</p>
<pre><code># Aufbereitungsplan
    # Personencode (1. Spalte, &quot;pcode&quot;)
        #Wandle pcode in Character-Variable um
# Suche nach pcodes kleiner/größer 8 Stellen und ersetze durch NA
        # Ersetze Kleinbuchstaben durch Großbuchstaben
        # Suche nach pcodes mit Datum (Punkt &quot;.&quot; suchen)  und ersetze durch NA
        # Suche nach doppelten pcodes
        # Prüfe mit View(), ob danach noch Aufbereitung nötig
#Likert-skalierte Variablen allgemein
        #Ersetze in allen Likert-Skalierten Variablen &quot;99&quot; durch NA
#Variablen Vorwissen (2 bis 6)
#Schließe Personen aus, die in ALLEN Variablen missing-Quoten von über 60% aufweisen.
# Variable VW.reflex: Umpolen
    # Abitur-Fachwahl-Variablen (7 bis 13, &quot;Abitur_Fach_...)
        # Ersetze nur für Personen mit mind. einer 1 = &quot;ja&quot; die NAs in den Abitur-
        # Fachwahl-Variablen durch 0 = Nein
        # Wandle die Variablen in Factor-Variablen (0=nein, 1=ja) um
    # Geschlecht (14, &quot;geschlecht&quot;)
        # Wandle in Factor-Variable um, 1=weiblich, 2=männlich, 3=divers, 4=keine Angabe
    # Alter (15, &quot;alter&quot;)
        # Addiere 16 auf alle Altersangaben
    # Dozent (18, &quot;dozent&quot;)
        #lösche die Variable</code></pre>
</div>
</div>
<div id="datenaufbereitung-durchführen" class="section level2 hasAnchor" number="3.8">
<h2><span class="header-section-number">3.8</span> Datenaufbereitung durchführen<a href="datenaufbereitung-in-r-praxisguide.html#datenaufbereitung-durchführen" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="personencode" class="section level3 hasAnchor" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Aufbereitung eines Personencodes<a href="datenaufbereitung-in-r-praxisguide.html#personencode" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Gemäß Aufbereitungsplan sind folgende Operationen zu realisieren:</p>
<pre><code># Personencode (1. Spalte, &quot;pcode&quot;)
        #Wandle pcode in Character-Variable um
# Suche nach pcodes kleiner/größer 8 Stellen und ersetze durch NA
        # Ersetze Kleinbuchstaben durch Großbuchstaben
        # Suche nach pcodes mit Datum (Punkt &quot;.&quot; suchen)  und ersetze durch NA
# Suche nach doppelten pcodes
        # Prüfe mit View(), ob danach noch Aufbereitung nötig</code></pre>
<p>Wir verfahren Schritt für Schritt:</p>
<pre><code>#Wandle pcode in Character-Variable um</code></pre>
<p>Der Personencode hat sich in der Aufbereitungsplanung als <code>Factor</code>-Variable mit über 400 Levels gezeigt. Da dies gerade für das Recodieren einiger pcodes ungünstige Hürden erzeugt, wandeln wir nun in das Format <em>Character</em> (Text) um:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb51-1" aria-hidden="true" tabindex="-1"></a>datensatz_renamed<span class="sc">$</span>pcode <span class="ot">&lt;-</span> <span class="fu">as.character</span>(datensatz_renamed<span class="sc">$</span>pcode)</span></code></pre></div>
<p>Der Befehl <code>as.character()</code> wandelt hierbei jeden anzeigbaren Text in tatsächlichen Text um. Von nun an können wir einfache Veränderungen an einzelnen Personencodes vornehmen.</p>
<p>Wir prüfen den Erfolg der Operation:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datensatz_renamed<span class="sc">$</span>pcode)</span></code></pre></div>
<pre><code>##  chr [1:546] &quot;01.01.2000&quot; &quot;01.04.1987&quot; &quot;06&quot; &quot;1.NA2.NA3.284.10&quot; &quot;141651&quot; ...</code></pre>
<p>Im nächsten Bereinigungsschritt wird geprüft, ob Personencodes zu wenige oder zu viele Zeichen aufweisen. Im strengsten Fall können diese direkt <code>NA</code> gesetzt werden:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suche nach pcodes kleiner/größer 8 Stellen und ersetze durch NA</span></span>
<span id="cb54-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb54-2" aria-hidden="true" tabindex="-1"></a>datensatz_renamed<span class="sc">$</span>pcode[<span class="fu">nchar</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">!=</span> <span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co">#man beachte das UNGLEICH !=</span></span></code></pre></div>
<p>Zudem sollen noch Klein- in Großbuchstaben umgewandelt werden:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ersetze Kleinbuchstaben durch Großbuchstaben----</span></span>
<span id="cb55-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb55-3" aria-hidden="true" tabindex="-1"></a>datensatz_renamed<span class="sc">$</span>pcode <span class="ot">&lt;-</span> <span class="fu">toupper</span>(datensatz_renamed<span class="sc">$</span>pcode)</span></code></pre></div>
<p>Bei der ersten Durchsicht der Daten zeigten sich auch Personencodes mit einem “.” (Punkt) darin:
Um Text bzw. Textteile (wie den Punkt) in R zu suchen, gibt es u. a. die Funktion <code>grepl()</code>. Der Aufbau dieser Funktion sieht im einfachsten Fall folgendermaßen aus:</p>
<pre><code>grepl(&quot;TEXT&quot;, Variable oder (Teil-)Datensatz) </code></pre>
<p>Der Output zeigt dann je Variable und Person mit einer 1 oder 0 an, ob der Text gefunden wurde oder nicht. So lassen sich zum Beispiel Personencodes finden und ggf. ändern, die einen Punkt (“.”) enthalten:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb57-1" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[<span class="fu">grepl</span>(<span class="st">&quot;.&quot;</span>, datensatz_renamed<span class="sc">$</span>pcode, <span class="at">fixed =</span> T), <span class="st">&quot;pcode&quot;</span>] </span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fixed = T sorgt dafür, dass Sonderzeichen wie ein Punkt oder ein &quot;$&quot; auch als solche</span></span>
<span id="cb59-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="co"># behandelt werden und nicht als Operatoren.</span></span>
<span id="cb59-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Output character(0) zeigt, dass bereits alle pcodes mit einem &quot;.&quot; entfernt sind. </span></span>
<span id="cb59-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Dies war bereits durch den vorherigen Schritt mit Zeichenzahl ungleich 8 geschehen.</span></span></code></pre></div>
<p>Auch mögliche doppelte Zeilen oder pcodes gilt es zu identifizieren und zu bereinigen:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Suche nach doppelten pcodes ----</span></span>
<span id="cb60-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode)) <span class="co"># TRUE zeigt an, dass ein pcode mind. 2mal vorkommt</span></span></code></pre></div>
<pre><code>## [1] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Einen Gesamtüberblick liefert table():</span></span>
<span id="cb62-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode)) </span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   515    31</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dies ist 31-mal der Fall</span></span>
<span id="cb64-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb64-3" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> T, <span class="st">&quot;pcode&quot;</span>] </span></code></pre></div>
<pre><code>##  [1] NA         NA         NA         NA         NA         NA        
##  [7] NA         NA         NA         NA         NA         NA        
## [13] NA         NA         NA         NA         NA         NA        
## [19] NA         NA         NA         NA         NA         NA        
## [25] NA         NA         NA         NA         NA         NA        
## [31] &quot;ANAN0770&quot;</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Die meisten Fälle sind einfach doppelte NA, aber </span></span>
<span id="cb66-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Person 31 scheint ein reales Duplikat zu sein</span></span>
<span id="cb66-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># mit der Bedingung is.na(datensatz_renamed$pcode) == F werden hier alle pcode = NA ausgeschlossen: </span></span>
<span id="cb66-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-5" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> T <span class="sc">&amp;</span></span>
<span id="cb66-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb66-6" aria-hidden="true" tabindex="-1"></a>     <span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F, <span class="st">&quot;pcode&quot;</span>] </span></code></pre></div>
<pre><code>## [1] &quot;ANAN0770&quot;</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># speichere extrahierten pcode in neuem (Character-)Objekt &quot;duplicated_pcodes&quot;:</span></span>
<span id="cb68-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-2" aria-hidden="true" tabindex="-1"></a>duplicated_pcodes <span class="ot">&lt;-</span></span>
<span id="cb68-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-3" aria-hidden="true" tabindex="-1"></a>  datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> T <span class="sc">&amp;</span></span>
<span id="cb68-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-4" aria-hidden="true" tabindex="-1"></a>       <span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F, <span class="st">&quot;pcode&quot;</span>] </span>
<span id="cb68-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Einfacher: Bei nur wenigen Fällen kann auch der betreffende pcode einfach kurz kopiert oder notiert werden</span></span>
<span id="cb68-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Zur Veranschaulichung: So sieht das erstellte Objekt aus:</span></span>
<span id="cb68-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb68-9" aria-hidden="true" tabindex="-1"></a>duplicated_pcodes</span></code></pre></div>
<pre><code>## [1] &quot;ANAN0770&quot;</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prüfe, ob Zeilen identisch sind:</span></span>
<span id="cb70-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb70-2" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[datensatz_renamed<span class="sc">$</span>pcode <span class="sc">%in%</span> duplicated_pcodes, ]</span></code></pre></div>
<pre><code>##        pcode VW.theo VW.prax VW.plan VW.durch VW.reflex Abitur_Fach_Biologie
## 20  ANAN0770       4       5       6        6         4                    1
## 546 ANAN0770       4       5       6        6         4                    1
##     Abitur_Fach_Chemie Abitur_Fach_Geographie Abitur_Fach_Geschichte
## 20                  NA                      1                     NA
## 546                 NA                      1                     NA
##     Abitur_Fach_Informatik Abitur_Fach_Physik Abitur_Fach_PW geschlecht alter
## 20                       1                 NA             NA          2    13
## 546                      1                 NA             NA          2    13
##     semester.pre abi dozent
## 20             1 3.5 Brämer
## 546            1 3.5 Brämer</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Die beiden Fälle sind identisch (für das erste Auftreten </span></span>
<span id="cb72-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="co"># des pcodes gilt duplicated=F, für das zweite duplicated = T), </span></span>
<span id="cb72-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># das zweite Auftreten des Falls wird also entfernt:</span></span>
<span id="cb72-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_renamed) <span class="co"># Fälle vorher</span></span></code></pre></div>
<pre><code>## [1] 546</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb74-1" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> T <span class="sc">&amp;</span> <span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F, <span class="st">&quot;pcode&quot;</span>]</span></code></pre></div>
<pre><code>## [1] &quot;ANAN0770&quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-1" aria-hidden="true" tabindex="-1"></a>datensatz_renamed <span class="ot">&lt;-</span></span>
<span id="cb76-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-2" aria-hidden="true" tabindex="-1"></a>  datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F <span class="sc">&amp;</span></span>
<span id="cb76-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-3" aria-hidden="true" tabindex="-1"></a>       <span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F, ] <span class="co"># Achtung: Nur duplicated = FALSE werden </span></span>
<span id="cb76-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ausgewählt. Zugleich werden hier alle pcode = NA ausgeschlossen</span></span>
<span id="cb76-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb76-6" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_renamed) </span></code></pre></div>
<pre><code>## [1] 514</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fälle hinterher: Es sind 32 weniger: </span></span>
<span id="cb78-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 31 doppelte pcodes: </span></span>
<span id="cb78-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 1-mal ANAN0770</span></span>
<span id="cb78-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># 30mal NA</span></span>
<span id="cb78-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 1 erster NA-pcode, der bewirkte, dass alle </span></span>
<span id="cb78-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># nachfolgenden duplicated = TRUE gesetzt wurden</span></span>
<span id="cb78-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-8" aria-hidden="true" tabindex="-1"></a>datensatz_renamed[<span class="fu">duplicated</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> T <span class="sc">&amp;</span></span>
<span id="cb78-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb78-9" aria-hidden="true" tabindex="-1"></a>     <span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode) <span class="sc">==</span> F, <span class="st">&quot;pcode&quot;</span>] </span></code></pre></div>
<pre><code>## character(0)</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># keine doppelten pcodes mehr</span></span></code></pre></div>
<p>Nun führen wir noch eine abschließende Prüfung durch:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfe &quot;per Auge&quot;, ob nun noch eine Aufbereitung nötig ist </span></span>
<span id="cb81-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(datensatz_renamed)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfe die Anzahlen gültiger Personencodes:</span></span>
<span id="cb82-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co">#zeigt Anzahl fehlender Werte (NA):</span></span>
<span id="cb82-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode)) </span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#zeigt Anzahl gültiger pcodes:</span></span>
<span id="cb84-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="sc">!</span><span class="fu">is.na</span>(datensatz_renamed<span class="sc">$</span>pcode)) </span></code></pre></div>
<pre><code>## [1] 514</code></pre>
<p>Die Bereinigung des Personencodes ist abgeschlossen. Wir indizieren dies über einen neuen Namen für den Datensatz:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb86-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode <span class="ot">&lt;-</span> datensatz_renamed</span></code></pre></div>
</div>
<div id="likert" class="section level3 hasAnchor" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Aufbereitung Likert-skalierter Variablen<a href="datenaufbereitung-in-r-praxisguide.html#likert" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Für die Likert-skalierten Variablen soll gemäß Aufbereitungsplan folgendes erfolgen:</p>
<pre><code>    #Likert-skalierte Variablen allgemein
        #Ersetze in allen Likert-skalierten Variablen &quot;99&quot; durch NA
    #Variablen Vorwissen (2 bis 6, &quot;VW...&quot;)
      #Schließe Personen aus, die in ALLEN Variablen missing-Quoten von über 60% aufweisen.
      # Variable VW.reflex: Umpolen</code></pre>
<p>Ein Problem betraf das Auftreten des Wertes “99” in den Likert-skalierten Vorwissens-Variablen (2 bis 6). Es gilt zunächst, diese Anomalie zu detektieren:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datensatz_cleaned_pcode[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">6</span>)]) </span></code></pre></div>
<pre><code>##     VW.theo        VW.prax          VW.plan         VW.durch    
##  Min.   :1.00   Min.   : 1.000   Min.   :1.000   Min.   :1.000  
##  1st Qu.:2.00   1st Qu.: 2.000   1st Qu.:1.000   1st Qu.:2.000  
##  Median :3.00   Median : 3.000   Median :2.000   Median :3.000  
##  Mean   :2.71   Mean   : 3.109   Mean   :2.546   Mean   :2.616  
##  3rd Qu.:4.00   3rd Qu.: 4.000   3rd Qu.:4.000   3rd Qu.:3.000  
##  Max.   :5.00   Max.   :99.000   Max.   :6.000   Max.   :6.000  
##  NA&#39;s   :221    NA&#39;s   :220      NA&#39;s   :221     NA&#39;s   :220    
##    VW.reflex    
##  Min.   :1.000  
##  1st Qu.:1.000  
##  Median :2.000  
##  Mean   :2.474  
##  3rd Qu.:3.000  
##  Max.   :6.000  
##  NA&#39;s   :221</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bei VW.prax existiert also eine einzige 99</span></span>
<span id="cb90-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Prüfe, welches der zugehörige Personencode ist:</span></span>
<span id="cb90-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datensatz_cleaned_pcode[datensatz_cleaned_pcode<span class="sc">$</span>VW.prax <span class="sc">==</span> <span class="dv">99</span>, <span class="st">&quot;pcode&quot;</span>])</span></code></pre></div>
<pre><code>## [1] NA         NA         &quot;ALLY2570&quot; NA         NA         NA</code></pre>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#ALLY2570 das ist der zugehörige pcode (neben einigen NA-Artefakten)</span></span></code></pre></div>
<p>Die Auffälligkeit wurde nur in der Variablen <code>VW.prax</code> gefunden und auch nur einmalig. Die 99 tritt bei der Proband:in mit dem Personencode <code>ALLY2570</code> auf. Ein Blick in die Ursprungsdaten mit Excel oder ein Betrachten des Fragenbogenentwurfs in der zugehörigen Software offenbart hier, dass es sich bei der 99 um ein reguläres <code>NA</code> handelt:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb93-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode[datensatz_cleaned_pcode<span class="sc">$</span>pcode <span class="sc">==</span> <span class="st">&quot;ALLY2570&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb93-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb93-2" aria-hidden="true" tabindex="-1"></a>     <span class="fu">is.na</span>(datensatz_cleaned_pcode<span class="sc">$</span>pcode) <span class="sc">==</span> F, <span class="st">&quot;VW.prax&quot;</span>] <span class="ot">&lt;-</span> <span class="cn">NA</span> <span class="co"># setze den Wert auf NA</span></span></code></pre></div>
<div id="basale-bereinigung-fehlender-werte-über-fallausschlüsse" class="section level4 hasAnchor" number="3.8.2.1">
<h4><span class="header-section-number">3.8.2.1</span> Basale Bereinigung fehlender Werte über Fallausschlüsse<a href="datenaufbereitung-in-r-praxisguide.html#basale-bereinigung-fehlender-werte-über-fallausschlüsse" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Zunächst sei vorangestellt, dass das Verwerfen von Daten mit einigen Verzerrungen der Ergebnisse einhergehen kann und daher oftmals Imputationen (Rekonstruktionen) fehlender Daten zu bevorzugen sind <span class="citation">(<a href="#ref-ludtke_umgang_2007" role="doc-biblioref">Lüdtke, Robitzsch, Trautwein &amp; Köller, 2007</a>)</span>. Für dieses einfache Beispiel möchten wir uns allerdings mit <em>listenweisen Fallausschlüssen</em> gemäß missing-Quote begnügen <span class="citation">(<a href="#ref-field_discovering_2012" role="doc-biblioref">Field, Miles &amp; Field, 2012, S. 216</a>)</span>.</p>
<p>Wir benötigen nun zunächst eine Information darüber, welche Personen hohe missing-Quoten von z. B. über 60% aufweisen, also 60% des Fragebogens nicht ausgefüllt haben. Diese Personen sehen wir hier als nicht-zuverlässige Datenquellen an und schließen sie aus der Analyse aus. Da das Feststellen von missing-Quoten eine sehr häufig wiederkehrende Notwendigkeit darstellt, schreiben wir eine Funktion (vgl. Kapitel <em>Basiswissen für R</em>), die wir dann stets für diesen Fall nutzen können:</p>
<p><strong>Funktion 1: help_percentmissing():</strong>
Berechnet je Proband:in (entspricht einer Zeile) den prozentualen Anteil fehlender Werte<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a>:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb94-1" aria-hidden="true" tabindex="-1"></a>help_percentmissing <span class="ot">=</span> <span class="cf">function</span>(x) {</span>
<span id="cb94-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sum</span>(<span class="fu">is.na</span>(x)) <span class="sc">/</span> <span class="fu">length</span>(x) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb94-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Hier wird die Summe aller Missings durch die Anzahl der </span></span>
<span id="cb94-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Antworten der Testteilnehmenden geteilt</span></span>
<span id="cb94-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb94-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nun wollen wir diese Funktion nicht nur auf eine:n Proband:in, sondern auf den ganzen Datensatz anwenden. Wir schreiben daher eine zweite Funktion, die die erste Funktion direkt nutzt:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-1" aria-hidden="true" tabindex="-1"></a>percentmissing <span class="ot">=</span> <span class="cf">function</span>(data) {</span>
<span id="cb95-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-2" aria-hidden="true" tabindex="-1"></a>  (<span class="fu">apply</span>(data, <span class="dv">1</span>, help_percentmissing)) </span>
<span id="cb95-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># apply() wendet eine Funktion auf multiple Instanzen an, hier, </span></span>
<span id="cb95-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># symbolisiert durch die &quot;1&quot;, auf alle Zeilen des Datensatzes </span></span>
<span id="cb95-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># (&quot;2&quot; wäre für alle Spalten)</span></span>
<span id="cb95-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb95-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nun wenden wir <code>percentmissing()</code> an:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_cleaned_pcode) <span class="co">#Proband:innen vorher</span></span></code></pre></div>
<pre><code>## [1] 514</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">percentmissing</span>(datensatz_cleaned_pcode))</span></code></pre></div>
<pre><code>##       11       12       13       14       15       16 
## 77.77778 77.77778 16.66667 27.77778 22.22222 77.77778</code></pre>
<p>Da der Output bei diesem großen Datensatz recht unübersichtlich gerät, bilden wir eine Tabelle. Diese fasst uns Fälle mit gleicher Anzahl prozentualer missings zusammen:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Die round()-Funktion bewirkt hier zusätzlich eine Darstellung mit zwei  Nachkommastellen:</span></span>
<span id="cb100-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">round</span>(<span class="fu">percentmissing</span>(datensatz_cleaned_pcode), <span class="at">digits =</span> <span class="dv">2</span>)) </span></code></pre></div>
<pre><code>## 
##  5.56 11.11 16.67 22.22 27.78 33.33 38.89    50 77.78 
##     7    26    61    57    18    10     2   113   220</code></pre>
<p>Der Output zeigt z. B., dass sieben Proband:innen eine missing-Quote von 5.56% aufweisen. Über den Befehl <code>summary(datensatz)</code> kann gesehen werden, dass vor allem die Abitur-Variablen (7 bis 13) hohe missing-Quoten aufweisen. Da diese (wie bereits in Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#aufplan">3.7.2</a> dargelegt) teils keine echten missings darstellen, sollten sie (temporär) für die Bestimmung der missing-Quoten ausgeschlossen werden:</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">percentmissing</span>(datensatz_cleaned_pcode[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)])) </span></code></pre></div>
<pre><code>## 
##                0 9.09090909090909 18.1818181818182 27.2727272727273 
##              177                3              113                1 
## 63.6363636363636 
##              220</code></pre>
<p>Das Ergebnis zeigt nun 177 Proband:innen mit missing-Quote 0% und 220 Personen mit über 60% missings.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a></p>
<p>Schließe also Proband:innen mit missng-Quote größer 60% aus:</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb104-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode <span class="ot">&lt;-</span></span>
<span id="cb104-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb104-2" aria-hidden="true" tabindex="-1"></a>  datensatz_cleaned_pcode[<span class="fu">percentmissing</span>(datensatz_cleaned_pcode[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) <span class="sc">&lt;</span> <span class="dv">60</span>, ]</span>
<span id="cb104-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(datensatz_cleaned_pcode) <span class="co">#294</span></span></code></pre></div>
<pre><code>## [1] 294</code></pre>
<p>Es verbleiben danach 294 Proband:innen.</p>
<p>Eine weitere zu bereinigende Likert-skalierte Variable war <code>VW.reflex</code>, hier sollte eine Umpolung erfolgen:</p>
<pre><code>    # Variable VW.reflex: Umpolen</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datensatz_cleaned_pcode<span class="sc">$</span>VW.reflex)</span></code></pre></div>
<pre><code>## 
##  1  2  3  4  5  6 
## 79 87 59 47 19  2</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb109-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode<span class="sc">$</span>VW.reflex <span class="ot">&lt;-</span> <span class="dv">7</span> <span class="sc">-</span> datensatz_cleaned_pcode<span class="sc">$</span>VW.reflex</span>
<span id="cb109-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Hier wird die Formel &quot;7 – Wert&quot; verwendet, um 1 in 6, 2 in 5 usw. zu recodieren.</span></span>
<span id="cb109-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datensatz_cleaned_pcode<span class="sc">$</span>VW.reflex)</span></code></pre></div>
<pre><code>## 
##  1  2  3  4  5  6 
##  2 19 47 59 87 79</code></pre>
<p>So wird die 1 in die 6 überführt usw.</p>
<p>Die erfolgreiche Datenbereinigung wird erneut durch einen neuen Namen des Datensatzes gekennzeichnet:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb111-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert <span class="ot">&lt;-</span> datensatz_cleaned_pcode</span></code></pre></div>
</div>
</div>
</div>
<div id="nominalvars" class="section level2 hasAnchor" number="3.9">
<h2><span class="header-section-number">3.9</span> Aufbereitung nominaler Variablen (z. B. Ja/Nein)<a href="datenaufbereitung-in-r-praxisguide.html#nominalvars" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Im Aufbereitungsplan zeigten sich die Abitur-Variablen auffällig:</p>
<pre><code># Abitur-Fachwahl-Variablen (7 bis 13, &quot;Abitur_Fach_...)
# Ersetze nur für Personen mit mind. einer 1 = &quot;ja&quot; die NAs in den Abitur-Fachwahl-
# Variablen durch 0 = Nein
        # Wandle die Variablen in Factor-Variablen (0=nein, 1=ja) um</code></pre>
<p>Bei diesen nominalen Variablen (z.B. Abitur_Fach_Physik) steht eine 1 für <em>Ja, im Abitur belegt</em> und eine 0 für <em>Nein, im Abitur nicht belegt</em>. Der Datensatz enthält aber gar keine 0, sondern stets <code>1</code> oder <code>NA</code>. Personen mit mind. einer 1 sollen daher in den restlichen <code>NA</code>-codierten Abitur-Variablen ein <code>0 = nein</code> erhalten. Bei Personen mit durchgängig <code>NAs</code> sollen diese erhalten bleiben, da die Person offensichtlich keines der Fächer angekreuzt und damit die Fragen mutmaßlich übersprungen hat.</p>
<p>Nun kann das Recodieren beginnen:</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 1: Setze alle NAs zunächst 0</span></span>
<span id="cb113-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bem.: is.na()-Funktion lässt sich auch auf ganze Dataframes anwenden. </span></span>
<span id="cb113-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Diejenigen Personen, die in Variable 7 (erste Abitur-Variable) ein NA aufweisen, </span></span>
<span id="cb113-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># erhalten als Wert in ihrer Variablen 7 eine 0</span></span>
<span id="cb113-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-5" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert[<span class="fu">is.na</span>(datensatz_cleaned_pcode_likert[, <span class="dv">7</span>]) <span class="sc">==</span> T, <span class="dv">7</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Für die zweite Abitur-Variable entsprechend:</span></span>
<span id="cb113-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-9" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert[<span class="fu">is.na</span>(datensatz_cleaned_pcode_likert[, <span class="dv">8</span>]) <span class="sc">==</span> T, <span class="dv">8</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb113-11" aria-hidden="true" tabindex="-1"></a><span class="co"># usw. bis 13</span></span></code></pre></div>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oder als Schleife:</span></span>
<span id="cb114-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb114-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-3" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert[<span class="fu">is.na</span>(datensatz_cleaned_pcode_likert[,i])<span class="sc">==</span>T,i] <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb114-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb114-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Überprüfe den Erfolg obiger Operationen: </span></span>
<span id="cb114-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 1) Zeile für Zeile:</span></span>
<span id="cb114-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datensatz_cleaned_pcode_likert[,<span class="dv">7</span>])</span></code></pre></div>
<pre><code>## 
##   0   1 
## 141 153</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># usw. bis 13</span></span>
<span id="cb116-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Oder 2) per Schleife und table():</span></span>
<span id="cb116-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb116-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">colnames</span>(datensatz_cleaned_pcode_likert)[i])</span>
<span id="cb116-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">table</span>(datensatz_cleaned_pcode_likert[, i]))</span>
<span id="cb116-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb116-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;Abitur_Fach_Biologie&quot;
## 
##   0   1 
## 141 153 
## [1] &quot;Abitur_Fach_Chemie&quot;
## 
##   0   1 
## 215  79 
## [1] &quot;Abitur_Fach_Geographie&quot;
## 
##   0   1 
## 209  85 
## [1] &quot;Abitur_Fach_Geschichte&quot;
## 
##   0   1 
## 140 154 
## [1] &quot;Abitur_Fach_Informatik&quot;
## 
##   0   1 
## 280  14 
## [1] &quot;Abitur_Fach_Physik&quot;
## 
##   0   1 
## 224  70 
## [1] &quot;Abitur_Fach_PW&quot;
## 
##   0   1 
## 210  84</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Oder 3) per describe():</span></span>
<span id="cb118-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(datensatz_cleaned_pcode_likert[,<span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) </span></code></pre></div>
<pre><code>##                        vars   n mean   sd median trimmed mad min max range
## Abitur_Fach_Biologie      1 294 0.52 0.50      1    0.53   0   0   1     1
## Abitur_Fach_Chemie        2 294 0.27 0.44      0    0.21   0   0   1     1
## Abitur_Fach_Geographie    3 294 0.29 0.45      0    0.24   0   0   1     1
## Abitur_Fach_Geschichte    4 294 0.52 0.50      1    0.53   0   0   1     1
## Abitur_Fach_Informatik    5 294 0.05 0.21      0    0.00   0   0   1     1
## Abitur_Fach_Physik        6 294 0.24 0.43      0    0.17   0   0   1     1
## Abitur_Fach_PW            7 294 0.29 0.45      0    0.23   0   0   1     1
##                         skew kurtosis   se
## Abitur_Fach_Biologie   -0.08    -2.00 0.03
## Abitur_Fach_Chemie      1.04    -0.93 0.03
## Abitur_Fach_Geographie  0.93    -1.15 0.03
## Abitur_Fach_Geschichte -0.09    -2.00 0.03
## Abitur_Fach_Informatik  4.23    15.92 0.01
## Abitur_Fach_Physik      1.22    -0.50 0.02
## Abitur_Fach_PW          0.94    -1.11 0.03</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Schritt 2: Setze die Personen mit überall 0 gleich überall NA:</span></span>
<span id="cb120-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Gewinne einen Eindruck über die Summe der Nullen und Einsen:</span></span>
<span id="cb120-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rowSums</span>(datensatz_cleaned_pcode_likert[, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]))</span></code></pre></div>
<pre><code>## 13 14 15 20 23 26 
##  5  2  3  3  5  0</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fragt, ob dies = 0 ist, also keine einzige 1=&quot;Ja&quot; vorhanden ist:</span></span>
<span id="cb122-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">rowSums</span>(datensatz_cleaned_pcode_likert[, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<pre><code>##    13    14    15    20    23    26 
## FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stellt das Ganze als Tabelle übersichtlich dar:</span></span>
<span id="cb124-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">rowSums</span>(datensatz_cleaned_pcode_likert[, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) <span class="sc">==</span> <span class="dv">0</span>) </span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##   179   115</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 115 Personen betrifft dies -&gt; Setze für Personen, die obige Bedingung erfüllen, die </span></span>
<span id="cb126-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Variablenwerte der Variablen 7 bis 13 gleich NA:</span></span>
<span id="cb126-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-3" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert[<span class="fu">rowSums</span>(datensatz_cleaned_pcode_likert[, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) <span class="sc">==</span> <span class="dv">0</span>, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)] <span class="ot">&lt;-</span></span>
<span id="cb126-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="cn">NA</span>     </span>
<span id="cb126-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="co"># prüfe Erfolg: </span></span>
<span id="cb126-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">rowSums</span>(datensatz_cleaned_pcode_likert[, <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>)]) <span class="sc">==</span> <span class="dv">0</span>) </span></code></pre></div>
<pre><code>## 
## FALSE 
##   179</code></pre>
<p>Nun enthalten die Abitur-Variablen die Werte <code>0</code>, <code>1</code> und <code>NA</code>. Wir wandeln sie hier noch in <code>Factor</code>-Variablen um (vgl. Kapitel <em>Basiswissen für R</em>):</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Wandle die Variablen in Factor-Variablen (0=nein, 1=ja) um unter </span></span>
<span id="cb128-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Nutzung der Variablen-Namen</span></span>
<span id="cb128-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="co"># (Auch die Spaltennummern wären hier möglich.)</span></span>
<span id="cb128-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-5" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert<span class="sc">$</span>Abitur_Fach_Biologie <span class="ot">&lt;-</span></span>
<span id="cb128-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(datensatz_cleaned_pcode_likert<span class="sc">$</span>Abitur_Fach_Biologie,</span>
<span id="cb128-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb128-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;nein&quot;</span>, <span class="st">&quot;ja&quot;</span>)) </span>
<span id="cb128-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Levels sind die &quot;Zahlenwerte&quot;, also 0 und 1. Labels sind die schriftlichen Entsprechungen, also &quot;nein&quot; und &quot;ja&quot;, die Reihenfolge ist relevant.</span></span></code></pre></div>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Oder als Schleife unter Nutzung der Spaltennummern der Variablen:</span></span>
<span id="cb129-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">7</span><span class="sc">:</span><span class="dv">13</span>) {</span>
<span id="cb129-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-3" aria-hidden="true" tabindex="-1"></a>  datensatz_cleaned_pcode_likert[, i] <span class="ot">&lt;-</span> <span class="fu">factor</span>(datensatz_cleaned_pcode_likert[, i],</span>
<span id="cb129-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb129-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;nein&quot;</span>, <span class="st">&quot;ja&quot;</span>))</span>
<span id="cb129-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb129-6" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p>Im Aufbereitungsplan gab es zudem auch die nominale Variable <code>geschlecht</code>:</p>
<pre><code># Geschlecht (14, &quot;geschlecht&quot;)
  # Wandle in Factor-Variable um, 1=weiblich, 2=männlich, 3=divers, 4=keine Angabe</code></pre>
<p>Prüfe zunächst die Variable:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datensatz_cleaned_pcode_likert<span class="sc">$</span>geschlecht) <span class="co">#ist schon factor mit 1, 2, 3 und 4, muss nur noch umbenennen</span></span></code></pre></div>
<pre><code>## [1] 1 1 3 2 1 4
## Levels: 1 2 3 4</code></pre>
<p>Es zeigt sich, dass die Variable bereits eine factor-Variable ist, allerdings nur mit Ziffern, ohne Labels:</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Auch hier ist die Reihenfolge bei &quot;level&quot; und &quot;label&quot; wieder entscheidend: </span></span>
<span id="cb133-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-2" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert<span class="sc">$</span>geschlecht <span class="ot">&lt;-</span></span>
<span id="cb133-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">factor</span>(</span>
<span id="cb133-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-4" aria-hidden="true" tabindex="-1"></a>    datensatz_cleaned_pcode_likert<span class="sc">$</span>geschlecht,</span>
<span id="cb133-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb133-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;weiblich&quot;</span>, <span class="st">&quot;männlich&quot;</span>, <span class="st">&quot;divers&quot;</span>, <span class="st">&quot;keine Angabe&quot;</span>) </span>
<span id="cb133-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb133-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb133-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datensatz_cleaned_pcode_likert<span class="sc">$</span>geschlecht) <span class="co">#prüfe</span></span></code></pre></div>
<pre><code>## [1] weiblich     weiblich     divers       männlich     weiblich    
## [6] keine Angabe
## Levels: weiblich männlich divers keine Angabe</code></pre>
<p>Die Zuordnung der numerischen levels zu den textbasierten labels ist also wie folgt: <code>1 = weiblich, 2 = männlich, 3 = divers, 4 = keine Angabe</code>.</p>
<p>Der Abschluss der Aufbereitung nominaler Daten wird im Datensatznamen vermerkt:</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb135-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert_nominal <span class="ot">&lt;-</span> datensatz_cleaned_pcode_likert</span></code></pre></div>
<div id="recodieren-einer-numerischen-variablen" class="section level3 hasAnchor" number="3.9.1">
<h3><span class="header-section-number">3.9.1</span> Recodieren einer numerischen Variablen<a href="datenaufbereitung-in-r-praxisguide.html#recodieren-einer-numerischen-variablen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Im Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#likert">3.8.2</a> haben wir bereits eine Likert-skalierte Variable umgepolt. Eine ähnliche <em>Recodierung</em> wenden wir nun auf die Variable <code>alter</code> an:</p>
<p>Die Variable <code>alter</code> muss gemäß Aufbereitungsplan neu codiert werden:</p>
<pre><code># Alter (15, &quot;alter&quot;)
  # Addiere 16 auf alle Altersangaben</code></pre>
<p>Dies lässt sich einfach durch Addition realisieren:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb137-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert_nominal<span class="sc">$</span>alter <span class="ot">&lt;-</span> <span class="dv">16</span> <span class="sc">+</span> datensatz_cleaned_pcode_likert_nominal<span class="sc">$</span>alter</span></code></pre></div>
</div>
<div id="löschen-von-variablen" class="section level3 hasAnchor" number="3.9.2">
<h3><span class="header-section-number">3.9.2</span> Löschen von Variablen<a href="datenaufbereitung-in-r-praxisguide.html#löschen-von-variablen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Zu guter Letzt wird noch die Variable <code>dozent</code> gemäß Aufbereitungsplan entfernt.</p>
<pre><code># Dozent (18, &quot;dozent&quot;)
        #lösche die Variable</code></pre>
<p>Das Löschen geschieht über den Wert <code>NULL</code></p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb139-1" aria-hidden="true" tabindex="-1"></a>datensatz_cleaned_pcode_likert_nominal<span class="sc">$</span>dozent <span class="ot">&lt;-</span> <span class="cn">NULL</span></span></code></pre></div>
<p>An dieser Stelle sollte davor gewarnt werden, Variablen mit tatsächlichen Daten vorschnell zu löschen. Meist ist es besser, diese zu behalten – beispielsweise umbenannt (z. B. Vorsilbe <code>trash_</code>) oder in einem <code>Papierkorb</code>-Dataframe.</p>
<p>Der Datensatz ist nun bereinigt:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb140-1" aria-hidden="true" tabindex="-1"></a>datensatz_clean <span class="ot">&lt;-</span> datensatz_cleaned_pcode_likert_nominal</span></code></pre></div>
<p>Nachfolgend werden noch fortgeschrittenere Techniken der Datenaufbereitung vorgestellt, wie das Verschmelzen von Datensätzen.</p>
</div>
</div>
<div id="fortgeschrittene-datenaufbereitung" class="section level2 hasAnchor" number="3.10">
<h2><span class="header-section-number">3.10</span> Fortgeschrittene Datenaufbereitung<a href="datenaufbereitung-in-r-praxisguide.html#fortgeschrittene-datenaufbereitung" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="zwei-datensätze-verschmelzen" class="section level3 hasAnchor" number="3.10.1">
<h3><span class="header-section-number">3.10.1</span> Zwei Datensätze verschmelzen<a href="datenaufbereitung-in-r-praxisguide.html#zwei-datensätze-verschmelzen" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Eine große Stärke von R ist der Umgang mit diversen Datensätzen gleichzeitig, da diese einfach als Objekte <code>datensatz</code>, <code>datensatz_2</code> usw. zwischengespeichert werden können.</p>
<p>Gerade stärkere Forschungsdesigns wie Längsschnitte (multiple Messzeitpunkte) oder Querschnitte mit multiplen Erhebungen (z. B. mehrere Parallelseminare oder Schulklassen, multiple Fächergruppen, multiple Standorte usw.) haben oftmals multiple Datensätze zur Folge. Eine übergreifende oder vergleichende Auswertung dieser erfordert allerdings in der Regel einen einzigen Datensatz, weshalb das <em>data-merging</em>, also das aggregieren verschiedener Datensätze in einen einzigen eine relevante Fähigkeit darstellt.
Ziel dieses Abschnitts ist es daher, für zwei häufige Fälle, Querschnitt multipler Gruppen und Längsschnitt einer Gruppe, zu zeigen, wie die Datensätze aggregiert werden können.</p>
<div id="querschnittsdaten-verschmelzen" class="section level4 hasAnchor" number="3.10.1.1">
<h4><span class="header-section-number">3.10.1.1</span> Querschnittsdaten verschmelzen<a href="datenaufbereitung-in-r-praxisguide.html#querschnittsdaten-verschmelzen" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Um den <em>Verschmelzungsprozess</em> nachvollziehbar zu gestalten, betrachten wir ein minimalistisches Beispiel von zwei Gruppen, einer Physik-Gruppe und einer Chemie-Gruppe. In beiden Gruppen hat bei drei Personen eine Befragung stattgefunden, es wurden die Personencodes, das Vorwissen, das Fach und das Alter abgefragt.
Wir konstruieren zunächst die minimalistischen Datensätze:</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-1" aria-hidden="true" tabindex="-1"></a>df_physik_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb141-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;GK1203&quot;</span>, <span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;WS4451&quot;</span>),</span>
<span id="cb141-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb141-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb141-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>)</span>
<span id="cb141-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-8" aria-hidden="true" tabindex="-1"></a>df_chemie_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb141-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;NN8780&quot;</span>, <span class="st">&quot;FD1212&quot;</span>, <span class="st">&quot;KK0996&quot;</span>),</span>
<span id="cb141-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb141-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb141-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>)</span>
<span id="cb141-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb141-14"><a href="datenaufbereitung-in-r-praxisguide.html#cb141-14" aria-hidden="true" tabindex="-1"></a>df_physik_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    21 Physik
## 3 WS4451             5    25 Physik</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb143-1" aria-hidden="true" tabindex="-1"></a>df_chemie_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 NN8780             2    21 Chemie
## 2 FD1212             4    21 Chemie
## 3 KK0996             5    25 Chemie</code></pre>
<p>An den Personencodes ist zunächst ersichtlich, dass weder innerhalb noch zwischen den Datensätzen doppelte Personen vorkommen (mehr dazu in Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#extra2">3.10.1.4</a>). Zudem sind alle Variablennamen in beiden Datensätzen 100% identisch und auch die Anzahl der Variablen gleich. Solche Fälle treten beispielsweise dann auf, wenn ein und derselbe Fragebogen unterschiedlichen Gruppen in je getrennten Erhebungen ausgehändigt wird.</p>
<p>Für diesen Fall genügt für ein Verschmelzen der Daten die Funktion <code>rbind()</code> (<em>row bind</em>), die namensgemäß die Zeilen aneinander <em>bindet</em>:</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb145-1" aria-hidden="true" tabindex="-1"></a>df_pre <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_physik_pre,df_chemie_pre)</span>
<span id="cb145-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb145-2" aria-hidden="true" tabindex="-1"></a>df_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    21 Physik
## 3 WS4451             5    25 Physik
## 4 NN8780             2    21 Chemie
## 5 FD1212             4    21 Chemie
## 6 KK0996             5    25 Chemie</code></pre>
<p>Nun haben wir einen einzigen Datensatz, mit dem wir weiterführende Analysen ausführen können. So könnte zum Beispiel (bei mehr Personen) ein t-Test für unverbundene Stichproben (Physik vs. Chemie) durchgeführt werden.
Komplexer wird das Verschmelzen von Längsschnittdaten, die im kommenden Abschnitt erläutert werden.</p>
</div>
<div id="laengsschnitt" class="section level4 hasAnchor" number="3.10.1.2">
<h4><span class="header-section-number">3.10.1.2</span> Längsschnittdaten verschmelzen<a href="datenaufbereitung-in-r-praxisguide.html#laengsschnitt" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Bei unserem Längsschnitt-Beispiel gehen wir von einer klassischen PRE-POST-Messung aus, es hat also eine Befragung zu Beginn (z. B. eines Seminars oder einer Unterrichtsreihe) stattgefunden und eine zum Ende hin. Dabei entstehen zwei Datensätze PRE und POST, die idealerweise je dieselben Personen enthalten. Als Indikator, dass zwei Personen identisch sind, dient hier der Personencode:</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-1" aria-hidden="true" tabindex="-1"></a>df_physik_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb147-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;GK1203&quot;</span>, <span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;WS4451&quot;</span>),</span>
<span id="cb147-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb147-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb147-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>)</span>
<span id="cb147-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-8" aria-hidden="true" tabindex="-1"></a>df_physik_post <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb147-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;WS4451&quot;</span>, <span class="st">&quot;GL8621&quot;</span>),</span>
<span id="cb147-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_post =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">3</span>),</span>
<span id="cb147-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">geschlecht =</span> <span class="fu">c</span>(<span class="st">&quot;w&quot;</span>, <span class="st">&quot;w&quot;</span>, <span class="st">&quot;m&quot;</span>)</span>
<span id="cb147-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb147-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb147-13" aria-hidden="true" tabindex="-1"></a>df_physik_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    21 Physik
## 3 WS4451             5    25 Physik</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb149-1" aria-hidden="true" tabindex="-1"></a>df_physik_post</span></code></pre></div>
<pre><code>##    pcode vorwissen_post geschlecht
## 1 ZB8900              5          w
## 2 WS4451              5          w
## 3 GL8621              3          m</code></pre>
<p>In unserem Beispiel ist zu erkennen, dass nur zwei Personen in beiden Datensätzen vorkommen (<code>ZB8900, WS4451</code>). Dies kann passieren, wenn Personen zu einem Messzeitpunkt nicht anwesend waren oder ihren Personencode falsch gebildet haben.
In jedem Fall wollen wir nun einen Datensatz bilden, der alle Daten dieser zwei Personen enthält und für die sonstigen Personen die vorhandenen Daten erhält. In R lässt sich dies über die <code>merge()</code>-Funktion realisieren:</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb151-1" aria-hidden="true" tabindex="-1"></a>df_physik <span class="ot">&lt;-</span> <span class="fu">merge</span>(df_physik_pre, df_physik_post, <span class="at">by =</span> <span class="st">&quot;pcode&quot;</span>, <span class="at">all =</span> T)</span></code></pre></div>
<p>Das Argument <code>by =</code> legt fest, durch welche Variable(n) die Gleichheit zweier Personen erkennbar ist, hier also lediglich der pcode. Das Argument <code>all = T</code> sorgt dafür, dass auch Personen ohne PRE-POST-matching erhalten bleiben (für die dadurch fehlenden Werte wird bei diesen Personen ein NA gesetzt).</p>
<p>Da es sich bei einer Längsschnittstudie meist um die gleichen Variablen zu unterschiedlichen Zeitpunkten handelt, sollte man hier insbesondere darauf achten, dass die wiederholt erhobenen Variablen das Präfix/Suffix <em>pre</em> bzw. <em>post</em> bekommen. Die <code>merge()</code>-Funktion in R würde sonst aus den verschiedenen Messzeitpunkten einen einzigen machen, was eine Datenanalyse im Längsschnitt unmöglich macht.
Betrachten wir den aggregierten Datensatz:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb152-1" aria-hidden="true" tabindex="-1"></a>df_physik</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach vorwissen_post geschlecht
## 1 GK1203             2    21 Physik             NA       &lt;NA&gt;
## 2 GL8621            NA    NA   &lt;NA&gt;              3          m
## 3 WS4451             5    25 Physik              5          w
## 4 ZB8900             4    21 Physik              5          w</code></pre>
<p>Der neue Datensatz zeigt für die identifizierten PRE-POST-aggregierbaren Personen (<code>ZB8900, WS4451</code>) vollständige Daten in allen Variablen an. Hier zeigt sich auch, warum die Umbenennung der (inhaltlich identischen) Variablen <code>vorwissen</code> in <code>pre</code> und <code>post</code> wichtig war.
Die beiden sonstigen Fälle weisen wie erwartet fehlende Werte (<code>NA</code>) auf.
Mit diesem Datensatz (mit mehr Personen) könnte dann etwa ein t-Test für verbundene Stichproben <span class="citation">(<a href="#ref-field_discovering_2012" role="doc-biblioref">Field et al., 2012, S. 386</a>)</span> durchgeführt werden.</p>
</div>
<div id="extra-1-querschnittsdaten-mit-unterschiedlichem-variablensatz-verschmelzen" class="section level4 hasAnchor" number="3.10.1.3">
<h4><span class="header-section-number">3.10.1.3</span> Extra 1: Querschnittsdaten mit unterschiedlichem Variablensatz verschmelzen<a href="datenaufbereitung-in-r-praxisguide.html#extra-1-querschnittsdaten-mit-unterschiedlichem-variablensatz-verschmelzen" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Manchmal müssen Querschnittsdaten mit unterschiedlichem Variablensatz verschmolzen werden. Diese entstehen z. B., wenn in zwei Fächern im Wesentlichen dieselben Variablen erhoben werden, aber eine davon fachspezifisch ist:</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-1" aria-hidden="true" tabindex="-1"></a>df_physik_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb154-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;GK1203&quot;</span>, <span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;WS4451&quot;</span>),</span>
<span id="cb154-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb154-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">physiknote =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb154-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb154-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Physik&quot;</span>)</span>
<span id="cb154-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb154-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-9" aria-hidden="true" tabindex="-1"></a>df_chemie_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb154-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;NN8780&quot;</span>, <span class="st">&quot;FD1212&quot;</span>, <span class="st">&quot;KK0996&quot;</span>),</span>
<span id="cb154-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb154-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">chemienote =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb154-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb154-14"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>)</span>
<span id="cb154-15"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb154-16"><a href="datenaufbereitung-in-r-praxisguide.html#cb154-16" aria-hidden="true" tabindex="-1"></a>df_physik_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre physiknote alter   fach
## 1 GK1203             2          1    21 Physik
## 2 ZB8900             4          2    21 Physik
## 3 WS4451             5          1    25 Physik</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb156-1" aria-hidden="true" tabindex="-1"></a>df_chemie_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre chemienote alter   fach
## 1 NN8780             2          2    21 Chemie
## 2 FD1212             4          1    21 Chemie
## 3 KK0996             5          2    25 Chemie</code></pre>
<p>Nun funktioniert das Verschmelzen mit <code>rbind()</code> nicht mehr, da <code>rbind()</code> identische Variablen benötigt:</p>
<pre><code>rbind(df_physik_pre, df_chemie_pre)</code></pre>
<p>Es entsteht dann die Fehlermeldung:</p>
<pre><code>#Fehler in match.names(clabs, names(xi)) : names do not match previous names</code></pre>
<p>Im Folgenden werden zwei Lösungsmöglichkeiten vorgestellt. Lösung 1 zeigt einen kleinschrittigen Weg und soll zum Verständnis der Operationen beitragen. Lösung 2 verstetigt diese Einzelschritte in Form einer handlichen eigenen Funktion, die dann für spätere Fälle wieder eingesetzt werden kann und den Aufwand auf eine Zeile Code minimiert.</p>
<p><strong>Lösung 1: kleinschrittig</strong></p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Nehme die Variablen physiknote und chemienote </span></span>
<span id="cb160-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (sind je an Stelle 3 im Datensatz) zunächst heraus:</span></span>
<span id="cb160-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-3" aria-hidden="true" tabindex="-1"></a>df_physik_pre_ohnephysiknote <span class="ot">&lt;-</span> df_physik_pre[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>)]</span>
<span id="cb160-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-4" aria-hidden="true" tabindex="-1"></a>df_chemie_pre_ohnechemienote <span class="ot">&lt;-</span> df_chemie_pre[, <span class="sc">-</span><span class="fu">c</span>(<span class="dv">3</span>)]</span>
<span id="cb160-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb160-6" aria-hidden="true" tabindex="-1"></a>df_physik_pre_ohnephysiknote</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    21 Physik
## 3 WS4451             5    25 Physik</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb162-1" aria-hidden="true" tabindex="-1"></a>df_chemie_pre_ohnechemienote</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 NN8780             2    21 Chemie
## 2 FD1212             4    21 Chemie
## 3 KK0996             5    25 Chemie</code></pre>
<p>Beide Datensätze enthalten nun exakt dieselben Variablennamen. Nun kann die <code>rbind()</code>-Funktion wieder eingesetzt werden:</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Verschmelze diese, nun identische Variablen enthaltenden, Teile:</span></span>
<span id="cb164-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb164-2" aria-hidden="true" tabindex="-1"></a>df_pre <span class="ot">&lt;-</span></span>
<span id="cb164-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb164-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(df_physik_pre_ohnephysiknote, df_chemie_pre_ohnechemienote)</span>
<span id="cb164-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb164-4" aria-hidden="true" tabindex="-1"></a>df_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    21 Physik
## 3 WS4451             5    25 Physik
## 4 NN8780             2    21 Chemie
## 5 FD1212             4    21 Chemie
## 6 KK0996             5    25 Chemie</code></pre>
<p>Nun können wir unser Wissen aus dem Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#laengsschnitt">3.10.1.2</a> anwenden. Wir wollen die Physiknote der folgenden Personen wieder in den Datensatz integrieren:</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb166-1" aria-hidden="true" tabindex="-1"></a>df_physik_pre_physiknote <span class="ot">&lt;-</span> df_physik_pre[,<span class="fu">c</span>(<span class="st">&quot;pcode&quot;</span>,<span class="st">&quot;physiknote&quot;</span>)]</span>
<span id="cb166-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb166-2" aria-hidden="true" tabindex="-1"></a>df_physik_pre_physiknote</span></code></pre></div>
<pre><code>##    pcode physiknote
## 1 GK1203          1
## 2 ZB8900          2
## 3 WS4451          1</code></pre>
<p>Da dieser Datensatz dieselben Personencodes enthält wie einige Personen im Datensatz df_pre, haben wir datentechnisch denselben Fall wie bei einem Längsschnitt, können also die Funktion <code>merge()</code> benutzen:</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb168-1" aria-hidden="true" tabindex="-1"></a>df_pre_inkl_physiknote <span class="ot">&lt;-</span></span>
<span id="cb168-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb168-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(df_pre, df_physik_pre_physiknote, <span class="at">by =</span> <span class="st">&quot;pcode&quot;</span>, <span class="at">all =</span></span>
<span id="cb168-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb168-3" aria-hidden="true" tabindex="-1"></a>          T)</span>
<span id="cb168-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb168-4" aria-hidden="true" tabindex="-1"></a>df_pre_inkl_physiknote</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach physiknote
## 1 FD1212             4    21 Chemie         NA
## 2 GK1203             2    21 Physik          1
## 3 KK0996             5    25 Chemie         NA
## 4 NN8780             2    21 Chemie         NA
## 5 WS4451             5    25 Physik          1
## 6 ZB8900             4    21 Physik          2</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dasselbe können wir für die Chemienote wiederholen:</span></span>
<span id="cb170-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb170-3" aria-hidden="true" tabindex="-1"></a>df_chemie_pre_chemienote <span class="ot">&lt;-</span> df_chemie_pre[,<span class="fu">c</span>(<span class="st">&quot;pcode&quot;</span>,<span class="st">&quot;chemienote&quot;</span>)]</span>
<span id="cb170-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb170-4" aria-hidden="true" tabindex="-1"></a>df_chemie_pre_chemienote</span></code></pre></div>
<pre><code>##    pcode chemienote
## 1 NN8780          2
## 2 FD1212          1
## 3 KK0996          2</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ein Zusammenfügen dieser beiden Datensätze ergibt dann das gewünschte Ergebnis:</span></span>
<span id="cb172-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb172-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-3" aria-hidden="true" tabindex="-1"></a>df_pre_final <span class="ot">&lt;-</span></span>
<span id="cb172-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">merge</span>(df_pre_inkl_physiknote, df_chemie_pre_chemienote, <span class="at">by =</span> <span class="st">&quot;pcode&quot;</span>, <span class="at">all =</span></span>
<span id="cb172-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-5" aria-hidden="true" tabindex="-1"></a>          T)</span>
<span id="cb172-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb172-6" aria-hidden="true" tabindex="-1"></a>df_pre_final</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach physiknote chemienote
## 1 FD1212             4    21 Chemie         NA          1
## 2 GK1203             2    21 Physik          1         NA
## 3 KK0996             5    25 Chemie         NA          2
## 4 NN8780             2    21 Chemie         NA          2
## 5 WS4451             5    25 Physik          1         NA
## 6 ZB8900             4    21 Physik          2         NA</code></pre>
<p><strong>Lösung 2: Eigene Funktion</strong></p>
<p><strong>Warnung:</strong> Diese Funktion funktioniert nur, wenn</p>
<ol style="list-style-type: lower-alpha">
<li>alle Variablen entweder vom Typ <code>numeric</code> oder <code>character</code> sind (keine <code>factor</code>-Variablen unterstützt, Umwandlung über <code>as.numeric()</code> oder <code>as.character()</code> möglich) und</li>
<li>die beiden Datensätze <code>x</code> und <code>y</code> komplett unterschiedliche Personencodes enthalten (vorher bitte prüfen).</li>
</ol>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-1" aria-hidden="true" tabindex="-1"></a>merge2 <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, identifier) {</span>
<span id="cb174-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-2" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">intersect</span>(<span class="fu">names</span>(x), <span class="fu">names</span>(y))</span>
<span id="cb174-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-3" aria-hidden="true" tabindex="-1"></a>  j <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(x), <span class="fu">names</span>(y))</span>
<span id="cb174-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(<span class="fu">names</span>(y), <span class="fu">names</span>(x))</span>
<span id="cb174-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-5" aria-hidden="true" tabindex="-1"></a>  merged_data_1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(x[, i], y[, i])</span>
<span id="cb174-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-6" aria-hidden="true" tabindex="-1"></a>  merged_data_2 <span class="ot">&lt;-</span></span>
<span id="cb174-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">merge</span>(merged_data_1, x[, <span class="fu">c</span>(identifier, j)], <span class="at">by =</span> identifier, <span class="at">all =</span> T)</span>
<span id="cb174-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-8" aria-hidden="true" tabindex="-1"></a>  merged_data_3 <span class="ot">&lt;-</span></span>
<span id="cb174-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">merge</span>(merged_data_2, y[, <span class="fu">c</span>(identifier, k)], <span class="at">by =</span> identifier, <span class="at">all =</span> T)</span>
<span id="cb174-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(merged_data_3)</span>
<span id="cb174-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb174-11" aria-hidden="true" tabindex="-1"></a>} </span></code></pre></div>
<p>Ohne zu sehr <em>in’s Detail</em> zu gehen, vollführt die Funktion ähnliche Operationen wie in Lösung 1: Mit der <code>intersect()</code>-Funktion werden gemeinsame Variablennamen gewonnen, mit <code>setdiff()</code> werden nicht-gemeinsame Variablennamen gewonnen. Die <code>rbind()</code>-Funktion fügt auch hier die gemeinsamen Variablenspalten aneinander, die <code>merge()</code>-Funktion übernimmt dann das Verschmelzen mit den je Datensatz einzigartigen Variablen.</p>
<p>Der Einsatz der Funktion ist (nachdem der Code der Funktion oben einmal ausgeführt wurde) denkbar einfach:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Das dritte Argument entspricht dem &quot;by = &quot;-Argument der regulären merge()-Funktion</span></span>
<span id="cb175-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb175-2" aria-hidden="true" tabindex="-1"></a>df_pre <span class="ot">&lt;-</span> <span class="fu">merge2</span>(df_physik_pre, df_chemie_pre, <span class="st">&quot;pcode&quot;</span>)</span>
<span id="cb175-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb175-3" aria-hidden="true" tabindex="-1"></a>df_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach physiknote chemienote
## 1 FD1212             4    21 Chemie         NA          1
## 2 GK1203             2    21 Physik          1         NA
## 3 KK0996             5    25 Chemie         NA          2
## 4 NN8780             2    21 Chemie         NA          2
## 5 WS4451             5    25 Physik          1         NA
## 6 ZB8900             4    21 Physik          2         NA</code></pre>
<p>Das Ergebnis entspricht dem aus Lösung 1.</p>
</div>
<div id="extra2" class="section level4 hasAnchor" number="3.10.1.4">
<h4><span class="header-section-number">3.10.1.4</span> Extra 2: Querschnittsdaten verschmelzen, die identische Personen enthalten<a href="datenaufbereitung-in-r-praxisguide.html#extra2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Bezogen auf unser Physik- und Chemie-Beispiel ist es denkbar, dass eine Person sowohl Physik, als auch Chemie belegt. Diese Person würde folglich sowohl an der Physik- als auch an der Chemie-Befragung teilnehmen und käme in beiden Datensätzen vor:</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-1" aria-hidden="true" tabindex="-1"></a>df_physik_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb177-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;GK1203&quot;</span>, <span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;WS4451&quot;</span>),</span>
<span id="cb177-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb177-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">25</span>, <span class="dv">25</span>),</span>
<span id="cb177-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Physik&quot;</span>,<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Physik&quot;</span>)</span>
<span id="cb177-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb177-7"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-8"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-8" aria-hidden="true" tabindex="-1"></a>df_chemie_pre <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb177-9"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">pcode =</span> <span class="fu">c</span>(<span class="st">&quot;NN8780&quot;</span>, <span class="st">&quot;FD1212&quot;</span>, <span class="st">&quot;ZB8900&quot;</span>),</span>
<span id="cb177-10"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">vorwissen_pre =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">5</span>),</span>
<span id="cb177-11"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">alter =</span> <span class="fu">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">25</span>),</span>
<span id="cb177-12"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">fach =</span> <span class="fu">c</span>(<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>,<span class="st">&quot;Chemie&quot;</span>)</span>
<span id="cb177-13"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb177-14"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb177-15"><a href="datenaufbereitung-in-r-praxisguide.html#cb177-15" aria-hidden="true" tabindex="-1"></a>df_physik_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 GK1203             2    21 Physik
## 2 ZB8900             4    25 Chemie
## 3 WS4451             5    25 Physik</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb179-1" aria-hidden="true" tabindex="-1"></a>df_chemie_pre</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 1 NN8780             2    21 Chemie
## 2 FD1212             4    21 Chemie
## 3 ZB8900             5    25 Chemie</code></pre>
<p>Das folgende Vorgehen eignet sich auch für deutlich größere Datensätze:</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Schritt 1: Prüfe, ob solche Fälle vorliegen:</span></span>
<span id="cb181-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb181-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Vektor mit allen pcodes hintereinander:</span></span>
<span id="cb181-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb181-3" aria-hidden="true" tabindex="-1"></a>pcodes <span class="ot">&lt;-</span> <span class="fu">c</span>(df_physik_pre<span class="sc">$</span>pcode,df_chemie_pre<span class="sc">$</span>pcode)</span>
<span id="cb181-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb181-4" aria-hidden="true" tabindex="-1"></a>pcodes</span></code></pre></div>
<pre><code>## [1] &quot;GK1203&quot; &quot;ZB8900&quot; &quot;WS4451&quot; &quot;NN8780&quot; &quot;FD1212&quot; &quot;ZB8900&quot;</code></pre>
<p>Für die Identifikation doppelter Personencodes gibt es die Funktion <code>duplicated()</code> (vgl. Abschnitt <a href="datenaufbereitung-in-r-praxisguide.html#personencode">3.8.1</a>). Diese gibt für alle Personencodes den Wert <code>TRUE</code> oder <code>FALSE</code> aus und analysiert dabei zuerst die Person 1, dann 2 usw. Wird ein <code>pcode</code> als <code>TRUE</code> gekennzeichnet, so kam dieser bereits vorher vor (Beispiel: Wenn Person 2 und 15 denselben pcode aufweisen, so steht dann <code>FALSE</code> bei Person 2 und <code>TRUE</code> bei Person 15).</p>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="fu">duplicated</span>(pcodes) </span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE  TRUE</code></pre>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co"># es gibt also Fälle, die &quot;TRUE&quot; sind</span></span>
<span id="cb185-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">duplicated</span>(pcodes)) <span class="co">#und zwar genau ein Paar</span></span></code></pre></div>
<pre><code>## 
## FALSE  TRUE 
##     5     1</code></pre>
<p>Identifiziere den Personencode:</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Schritt 2: Welcher pcode gehört dazu?</span></span>
<span id="cb187-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb187-2" aria-hidden="true" tabindex="-1"></a>pcodes[<span class="fu">duplicated</span>(pcodes)] <span class="co"># Es ist der pcode ZB8900</span></span></code></pre></div>
<pre><code>## [1] &quot;ZB8900&quot;</code></pre>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Betrachte Daten dieser Person je Datensatz:</span></span>
<span id="cb189-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb189-2" aria-hidden="true" tabindex="-1"></a>df_physik_pre[df_physik_pre<span class="sc">$</span>pcode<span class="sc">==</span><span class="st">&quot;ZB8900&quot;</span>,]</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 2 ZB8900             4    25 Chemie</code></pre>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb191-1" aria-hidden="true" tabindex="-1"></a>df_chemie_pre[df_chemie_pre<span class="sc">$</span>pcode<span class="sc">==</span><span class="st">&quot;ZB8900&quot;</span>,]</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach
## 3 ZB8900             5    25 Chemie</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Das Alter stimmt auch überein =&gt; Das ist ein und dieselbe Person!</span></span>
<span id="cb193-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb193-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb193-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ziel: Doppelte Person im Physik-Datensatz entfernen, aber alle Daten erhalten. =&gt; Nur vorwissen_pre ist unterschiedlich =&gt; Bilde Mittelwert 4.5</span></span>
<span id="cb193-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb193-4" aria-hidden="true" tabindex="-1"></a>df_chemie_pre[df_chemie_pre<span class="sc">$</span>pcode <span class="sc">==</span> <span class="st">&quot;ZB8900&quot;</span>, <span class="st">&quot;vorwissen_pre&quot;</span>] <span class="ot">&lt;-</span></span>
<span id="cb193-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb193-5" aria-hidden="true" tabindex="-1"></a>  <span class="fl">4.5</span></span></code></pre></div>
<p>Die Person hat, wie es bei Fragebogenfragen üblich ist, das Kreuz beim Vorwissen nicht exakt gleich gesetzt. Eine Möglichkeit ist hier, den Mittelwert zu bilden.</p>
<p>Aus dem Physik-Datensatz soll nun die doppelte Person entfernt werden:</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="co">#man beachte das UNGLEICH !=</span></span>
<span id="cb194-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-2" aria-hidden="true" tabindex="-1"></a>df_physik_pre <span class="ot">&lt;-</span> df_physik_pre[df_physik_pre<span class="sc">$</span>pcode <span class="sc">!=</span> <span class="st">&quot;ZB8900&quot;</span>, ] </span>
<span id="cb194-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-4"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-4" aria-hidden="true" tabindex="-1"></a><span class="co">#prüfe Erfolg durch Wiederholung der ersten Code-Zeilen:</span></span>
<span id="cb194-5"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-5" aria-hidden="true" tabindex="-1"></a>pcodes <span class="ot">&lt;-</span> <span class="fu">c</span>(df_physik_pre<span class="sc">$</span>pcode, df_chemie_pre<span class="sc">$</span>pcode)</span>
<span id="cb194-6"><a href="datenaufbereitung-in-r-praxisguide.html#cb194-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">duplicated</span>(pcodes))</span></code></pre></div>
<pre><code>## 
## FALSE 
##     5</code></pre>
<p>Es sind nun keine doppelten Fälle mehr vorhanden und es kann z. B. mit dem Verschmelzen der Datensätze begonnen werden.</p>
</div>
</div>
<div id="zeitformate-in-r" class="section level3 hasAnchor" number="3.10.2">
<h3><span class="header-section-number">3.10.2</span> Zeitformate in R<a href="datenaufbereitung-in-r-praxisguide.html#zeitformate-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In manchen Untersuchungen ist es notwendig mit sog. <em>Timecodes</em> (bspw. <em>Stunde:Minute:Sekunde</em>) zu arbeiten. Dies kann beispielsweise eine Reaktionszeit einer Person oder die durchschnittliche Zeit zum Lösen einer Aufgabe in einem Test sein. R kann mit diesem Format wenig Rechenoperationen durchführen, weshalb es von Vorteil ist, dieses in Sekunden bzw. je nach Format in die kleinste mögliche Einheit umzuwandeln.</p>
<p>In unserem Fall handelt es sich um einen Datensatz, welcher die Zeit zum Lösen einer Aufgabe pro Proband:in enthält. Diese wird im Format <em>Stunde:Minute:Sekunde</em> dargestellt. Wir betrachten zunächst die Daten:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb196-1" aria-hidden="true" tabindex="-1"></a>dfr</span></code></pre></div>
<pre><code>##    pcode vorwissen_pre alter   fach    zeit1    zeit2
## 1 GK1203             2    21 Physik 00:06:01 00:05:49
## 2 ZB8900             4    25 Chemie 00:05:10  00:05:2
## 3 WS4451             5    25 Physik 00:07:15 00:04:33</code></pre>
<p>Zunächst sollten wir auch hier darauf achten, mögliche Faktoreigenschafften zu entfernen (über <code>as.numeric()</code>, s.u.). Danach können wir die Daten mit folgendem Code umwandeln (Erläuterung folgt):</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="datenaufbereitung-in-r-praxisguide.html#cb198-1" aria-hidden="true" tabindex="-1"></a>dfr[, <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)] <span class="ot">&lt;-</span></span>
<span id="cb198-2"><a href="datenaufbereitung-in-r-praxisguide.html#cb198-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(dfr[, <span class="fu">c</span>(<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>)], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="cf">function</span>(x)</span>
<span id="cb198-3"><a href="datenaufbereitung-in-r-praxisguide.html#cb198-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.numeric</span>(<span class="fu">as.difftime</span>(x, <span class="at">format =</span> <span class="st">&quot;%H:%M:%S&quot;</span>, <span class="at">units =</span> <span class="st">&quot;sec&quot;</span>))) </span></code></pre></div>
<p>Die <code>apply()</code>-Funktion wendet zunächst alle weiteren Schritte nur auf die Spalten 5 und 6 an. Dies sind die Variablen mit Zeitinformationen. In diesen Spalten wird nun zunächst der Timecode als solcher erkannt (<code>as.difftime()</code>) und das passende Urspungs-Format (<code>format = "%H:%M:%S"</code>) sowie Zielformat bzw. die Zieleinheit (<code>units = "sec"</code>) angegeben. Im Anschluss wird mit der <code>as.numeric()</code>-Funktion dieses neue Format in ein <code>Numeric</code>-Datenformat (<em>Zahl</em>) umgewandelt, mit dem R später rechnen kann.</p>
<p>Hat man die Daten entsprechend umgewandelt, lassen sich alle weiteren Berechnungen wie bspw. t-Tests o. Ä. problemlos durchführen. Möchte man eine andere Einheit (bspw. Minuten statt Sekunden) verwenden, kann man den das Argument <code>units</code> entsprechend anpassen (<code>units = "min"</code>).</p>

</div>
</div>
</div>
<h3> Bibliographie<a href="bibliographie.html#bibliographie" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-field_discovering_2012" class="csl-entry">
Field, A. P., Miles, J. &amp; Field, Z. (2012). <em>Discovering statistics using R</em>. London ; Thousand Oaks, Calif: Sage.
</div>
<div id="ref-ludtke_umgang_2007" class="csl-entry">
Lüdtke, O., Robitzsch, A., Trautwein, U. &amp; Köller, O. (2007). Umgang mit fehlenden Werten in der psychologischen Forschung. <em>Psychologische Rundschau</em>, <em>58</em>(2), 103–117.
</div>
<div id="ref-porst_fragebogen_2014" class="csl-entry">
Porst, R. (2014). <em>Fragebogen: ein Arbeitsbuch</em> (Studienskripten zur Soziologie) (4., erw. Aufl.). Wiesbaden: Springer VS.
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Mit <code>apply(datensatz, 2, help_percentmissing)</code> können auch missing-Quoten je Variable bestimmt werden.<a href="datenaufbereitung-in-r-praxisguide.html#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>Die hohen missing-Quoten stammen aus nicht-erfolgreich verlaufenden matchings und technischen Importartefakten wie ganzen NA-Zeilen: Es sind also <em>verwaiste</em> Fälle und technisch bedingte Leerfälle.<a href="datenaufbereitung-in-r-praxisguide.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="basiswissen-für-r-praxisguide.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="praxisorientierte-einführung-in-die-item-response-theorie-mit-dem-fokus-auf-das-rasch-modell.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
